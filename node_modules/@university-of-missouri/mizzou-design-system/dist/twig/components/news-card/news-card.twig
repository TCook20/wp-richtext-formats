
{% macro NewsCard( options ) %}
{% spaceless %}
  {# Imports #}
    {% import "@miz/utilities/twig/utils.twig" as utils %}
    {% from "@miz/components/card/card.twig" import Card as card %}

  {# Parameters #}
    {% set newsCardClass       = 'miz-news-card' %}
    {% set newsCardClass       = options.class ? utils.AppendClasses( newsCardClass, options.class ) : newsCardClass %}
    {% set newsCardAttributes  = options.attributes is defined ? options.attributes : {} %}
    {% set newsCardLink        = options.link is defined ? options.link : false %}
    {% set newsCardContents    = options.contents %}

  {# Variables #}

    {# Content #}
    {% set cardContents = [] %}

    {% for content in newsCardContents %}

      {# Topic #}
      {% if content.type == 'topic' -%}
        {% set topicOptions = {
          "type": "text",
          "class": "miz-news-card__topic"
        } %}
        {% set mergeContent = content %}
        {% set mergeContent = mergeContent|merge(mergeContent, topicOptions) %}

        {% set cardContents = cardContents|merge([mergeContent]) %}

      {# Thumbnails #}
      {% elseif content.type == 'thumb' %}
        {% set mergeContent %}
          <div class="miz-news-card__thumb-container">
            <img src="{{content.src}}" alt="{{content.alt}}" class="miz-news-card__thumb">
          </div>
        {% endset %}

        {% set cardContents = cardContents|merge([mergeContent]) %}

      {# Everything else #}
      {% else %}
        {% set cardContents = cardContents|merge([content]) %}
      {% endif %}

    {% endfor %}

    {% set cardOptions = {
      "class": newsCardClass,
      "attributes": newsCardAttributes,
      "contents": cardContents
    } %}

{% endspaceless %}
  <a class="miz-linked-card" href="{{ newsCardLink.href }}">
    {{ card( cardOptions ) }}
  </a>
{% endmacro %}
