{#
  Block Message
  Base Block Message component

  @uses AppendClasses, AddAttributes from utils
  @uses Icon from @miz/components/Icon/Icon.twig

  @param  {object}  options
  @param  {object}  ├─ block-message
  @param  {string}  │  ├─ options.class
  @param  {object}  │  ├─ options.attributes
  @param  {string}  │  ├─ options.title
  @param  {string}  │  ├─ options.datetime
  @param  {string}  │  └─ options.text
  @param  {object}  └─ icon See Icon component for options

 #}
{%- spaceless %}

{# Imports #}
  {% import "@miz/utilities/twig/utils.twig" as utils %}
  {% from "@miz/components/icon/icon.twig" import Icon as blockMessageIcon %}

{# Parameters #}
{% set options = _context
  ? _context
  : {} %}

{# Variables #}
  {% set blockMessageOptions = options["block-message"] %}
  {% set blockMessageClass = "miz-block-message" %}
  {% set blockMessageClass = utils.AppendClasses( blockMessageClass, blockMessageOptions.class ) %}
  {% set blockMessageAttributes = utils.AddAttributes( blockMessageOptions.attributes ) %}
  {% set blockMessageTitle = blockMessageOptions.title %}
  {% set blockMessageDatetime = blockMessageOptions.datetime %}
  {% set blockMessageText = blockMessageOptions.text %}

  {% set iconOptions = options.icon %}

  {% if iconOptions %}

    {% set iconClass = "miz-block-message__icon" %}
    {% set iconClass = iconOptions ? utils.AppendClasses( iconClass, iconOptions.class ) %}
    {% set iconName = iconOptions.name %}
    {% set blockMessageIconOptions = {
      "name": iconName,
      "class": iconClass
    } %}

  {% endif %}

{% endspaceless -%}

{# Output #}
  <div class="{{ blockMessageClass }}" {{ blockMessageAttributes }}>
    <div class="miz-block-message__header">

      {% if iconOptions -%}

        <h2 class="miz-block-message__title miz-block-message__title--icon">{% if blockMessageIcon %}{{ blockMessageIcon( blockMessageIconOptions )|trim -}} {% endif %}{{ blockMessageTitle }}</h2>

      {% else -%}

        <h2 class="miz-block-message__title">{{ blockMessageTitle }}</h2>

      {% endif -%}

      {% if blockMessageDatetime %}
        <time class="miz-block-message__pubdate">{{ blockMessageDatetime }}</time>
      {% endif %}

    </div>

    <div class="miz-block-message__content">
      <p class="miz-block-message__text">{{ blockMessageText }}</p>
    </div>

  </div>
