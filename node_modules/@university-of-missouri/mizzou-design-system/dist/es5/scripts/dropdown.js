"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var utils_1 = require("./utils");
var toggle_1 = require("./toggle");
// CSS for dropdowns
var dropdownCSS = {
    container: 'miz-dropdown',
    show_content: 'show',
};
// Button data attribute
var dropdownButtonAttribute = 'data-miz-toggle-controls';
exports.default = (function () {
    // Locate all the dropdown containers in the document and store in a collection
    var dropdownCollection = document.getElementsByClassName(dropdownCSS.container);
    var _loop_1 = function (i) {
        var dropdown = dropdownCollection[i];
        var dropdownController = dropdown.querySelector("[".concat(dropdownButtonAttribute, "]"));
        if (dropdownController !== null) {
            var dropdownContent_1 = document.getElementById(dropdownController.dataset.mizToggleControls);
            var hideThis_1 = function () {
                dropdownController.classList.remove('active');
                dropdownContent_1.hidden = true;
                return (0, toggle_1.hide)(dropdownController, dropdownContent_1, dropdownCSS.show_content);
            };
            dropdown.addEventListener('click', function (e) {
                if (dropdownController.contains(e.target)) {
                    if (dropdownContent_1.classList.contains(dropdownCSS.show_content)) {
                        dropdownContent_1.style.maxHeight = dropdownContent_1.offsetHeight;
                        hideThis_1();
                    }
                    else {
                        (0, toggle_1.show)(dropdownController, dropdownContent_1, dropdownCSS.show_content);
                        dropdownContent_1.hidden = false;
                        (0, utils_1.detect)(dropdown, dropdownController, hideThis_1);
                        dropdownController.classList.add('active');
                    }
                }
            });
        }
    };
    for (var i = 0; i < dropdownCollection.length; i += 1) {
        _loop_1(i);
    }
});
