{#
/**
 * @macro
 * Alert
 * Base Alert component. Builds a MU Alert message using the <article> element.
 *
 * @uses   AppendClasses, AddAttributes from @miz/utilties/utils.twig
 *
 * Parameters:
 * @param  array params: Alert parameters
 *    params
 *    ├─ 'class'        => string
 *    ├─ 'attributes'   => array
 *    ├─ 'type'         => string   (severe|warning|info|clear)
 *    ├─ 'contents'     => string   Include HTML as string to output.
 *    └─ 'link'         => array    Hash link value. link.href is only supported value
 *        └─ 'href'     => string   URL to place in the anchor
 */
#}
{% macro Alert(params) %}
  {%- spaceless %}

    {# Imports #}
    {% import "@miz/utilities/twig/utils.twig" as utils %}
    {% from "@miz/components/Icon/Icon.twig" import Icon as icon %}

    {# Parameters #}
    {% set alert_class = "miz-alert" %}
    {% set alert_type = params.type ? params.type : null %}
    {% set alert_class = alert_type is not null ? utils.AppendClasses(alert_class, alert_class ~ '--' ~ alert_type) : alert_class %}
    {% set alert_class = params.class ? utils.AppendClasses(alert_class, params.class) : alert_class %}
    {% set alert_attributes = params.attributes ? utils.AddAttributes(params.attributes) : null %}
    {% set alert_contents = params.contents ? params.contents : false %}

    {% set alert_icon = params.icon ? params.icon : false %}
    {% if alert_icon %}
      {% set alert_icon_class = "miz-alert__icon" %}
      {% set alert_icon_class = alert_icon['class'] ? utils.AppendClasses(alert_icon_class, alert_icon['class']) : alert_icon_class %}
      {% set alert_icon = {
        "class": alert_icon_class,
        "name": alert_icon['name']
      } %}
    {% endif %}

    {% set alert_link = params.link ? params.link : false %}
    {% if alert_link %}
      {% set alert_link_class = "miz-linked-alert" %}
      {% set alert_link_class = alert_link['class'] ? utils.AppendClasses(alert_link_class, alert_link['class']) : alert_link_class %}
    {% endif %}

  {% endspaceless -%}

  {# Output #}
  {% if alert_contents and alert_link %}
    <a href="{{ alert_link.href }}" class="{{ alert_link_class }}">
      <article class="{{ alert_class }}"{{ alert_attributes }}>
        {{ alert_icon ? icon(alert_icon) }}
        {{ alert_contents }}
      </article>
    </a>
  {% elseif alert_contents %}
    <article class="{{ alert_class }}"{{ alert_attributes }}>
      {{ alert_icon ? icon(alert_icon) }}
      {{ alert_contents }}
    </article>
  {% endif %}

{% endmacro %}
