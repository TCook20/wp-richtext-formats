{"version":3,"names":["createElement","render","ContextProvider","props","getChildContext","context","children","Portal","_this","container","_container","componentWillUnmount","_temp","_vnode","nodeType","parentNode","childNodes","appendChild","child","push","insertBefore","removeChild","splice","indexOf","createPortal","vnode","el","containerInfo"],"sources":["@wordpress/interactivity/src/portals.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { createElement, render } from 'preact';\n\n/**\n * @param {import('../../src/index').RenderableProps<{ context: any }>} props\n */\nfunction ContextProvider( props ) {\n\tthis.getChildContext = () => props.context;\n\treturn props.children;\n}\n\n/**\n * Portal component\n *\n * @this {import('./internal').Component}\n * @param {object | null | undefined} props\n *\n *                                          TODO: use createRoot() instead of fake root\n */\nfunction Portal( props ) {\n\tconst _this = this;\n\tconst container = props._container;\n\n\t_this.componentWillUnmount = function () {\n\t\trender( null, _this._temp );\n\t\t_this._temp = null;\n\t\t_this._container = null;\n\t};\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif ( _this._container && _this._container !== container ) {\n\t\t_this.componentWillUnmount();\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif ( props._vnode ) {\n\t\tif ( ! _this._temp ) {\n\t\t\t_this._container = container;\n\n\t\t\t// Create a fake DOM parent node that manages a subset of `container`'s children:\n\t\t\t_this._temp = {\n\t\t\t\tnodeType: 1,\n\t\t\t\tparentNode: container,\n\t\t\t\tchildNodes: [],\n\t\t\t\tappendChild( child ) {\n\t\t\t\t\tthis.childNodes.push( child );\n\t\t\t\t\t_this._container.appendChild( child );\n\t\t\t\t},\n\t\t\t\tinsertBefore( child ) {\n\t\t\t\t\tthis.childNodes.push( child );\n\t\t\t\t\t_this._container.appendChild( child );\n\t\t\t\t},\n\t\t\t\tremoveChild( child ) {\n\t\t\t\t\tthis.childNodes.splice(\n\t\t\t\t\t\t// eslint-disable-next-line no-bitwise\n\t\t\t\t\t\tthis.childNodes.indexOf( child ) >>> 1,\n\t\t\t\t\t\t1\n\t\t\t\t\t);\n\t\t\t\t\t_this._container.removeChild( child );\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\t// Render our wrapping element into temp.\n\t\trender(\n\t\t\tcreateElement(\n\t\t\t\tContextProvider,\n\t\t\t\t{ context: _this.context },\n\t\t\t\tprops._vnode\n\t\t\t),\n\t\t\t_this._temp\n\t\t);\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if ( _this._temp ) {\n\t\t_this.componentWillUnmount();\n\t}\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n *\n * @param {import('./internal').VNode}         vnode     The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal( vnode, container ) {\n\tconst el = createElement( Portal, {\n\t\t_vnode: vnode,\n\t\t_container: container,\n\t} );\n\tel.containerInfo = container;\n\treturn el;\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,aAAa,EAAEC,MAAM,QAAQ,QAAQ;;AAE9C;AACA;AACA;AACA,SAASC,eAAeA,CAAEC,KAAK,EAAG;EACjC,IAAI,CAACC,eAAe,GAAG,MAAMD,KAAK,CAACE,OAAO;EAC1C,OAAOF,KAAK,CAACG,QAAQ;AACtB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,MAAMA,CAAEJ,KAAK,EAAG;EACxB,MAAMK,KAAK,GAAG,IAAI;EAClB,MAAMC,SAAS,GAAGN,KAAK,CAACO,UAAU;EAElCF,KAAK,CAACG,oBAAoB,GAAG,YAAY;IACxCV,MAAM,CAAE,IAAI,EAAEO,KAAK,CAACI,KAAM,CAAC;IAC3BJ,KAAK,CAACI,KAAK,GAAG,IAAI;IAClBJ,KAAK,CAACE,UAAU,GAAG,IAAI;EACxB,CAAC;;EAED;EACA;EACA,IAAKF,KAAK,CAACE,UAAU,IAAIF,KAAK,CAACE,UAAU,KAAKD,SAAS,EAAG;IACzDD,KAAK,CAACG,oBAAoB,CAAC,CAAC;EAC7B;;EAEA;EACA;EACA,IAAKR,KAAK,CAACU,MAAM,EAAG;IACnB,IAAK,CAAEL,KAAK,CAACI,KAAK,EAAG;MACpBJ,KAAK,CAACE,UAAU,GAAGD,SAAS;;MAE5B;MACAD,KAAK,CAACI,KAAK,GAAG;QACbE,QAAQ,EAAE,CAAC;QACXC,UAAU,EAAEN,SAAS;QACrBO,UAAU,EAAE,EAAE;QACdC,WAAWA,CAAEC,KAAK,EAAG;UACpB,IAAI,CAACF,UAAU,CAACG,IAAI,CAAED,KAAM,CAAC;UAC7BV,KAAK,CAACE,UAAU,CAACO,WAAW,CAAEC,KAAM,CAAC;QACtC,CAAC;QACDE,YAAYA,CAAEF,KAAK,EAAG;UACrB,IAAI,CAACF,UAAU,CAACG,IAAI,CAAED,KAAM,CAAC;UAC7BV,KAAK,CAACE,UAAU,CAACO,WAAW,CAAEC,KAAM,CAAC;QACtC,CAAC;QACDG,WAAWA,CAAEH,KAAK,EAAG;UACpB,IAAI,CAACF,UAAU,CAACM,MAAM;UACrB;UACA,IAAI,CAACN,UAAU,CAACO,OAAO,CAAEL,KAAM,CAAC,KAAK,CAAC,EACtC,CACD,CAAC;UACDV,KAAK,CAACE,UAAU,CAACW,WAAW,CAAEH,KAAM,CAAC;QACtC;MACD,CAAC;IACF;;IAEA;IACAjB,MAAM,CACLD,aAAa,CACZE,eAAe,EACf;MAAEG,OAAO,EAAEG,KAAK,CAACH;IAAQ,CAAC,EAC1BF,KAAK,CAACU,MACP,CAAC,EACDL,KAAK,CAACI,KACP,CAAC;EACF;EACA;EACA;EAAA,KACK,IAAKJ,KAAK,CAACI,KAAK,EAAG;IACvBJ,KAAK,CAACG,oBAAoB,CAAC,CAAC;EAC7B;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASa,YAAYA,CAAEC,KAAK,EAAEhB,SAAS,EAAG;EAChD,MAAMiB,EAAE,GAAG1B,aAAa,CAAEO,MAAM,EAAE;IACjCM,MAAM,EAAEY,KAAK;IACbf,UAAU,EAAED;EACb,CAAE,CAAC;EACHiB,EAAE,CAACC,aAAa,GAAGlB,SAAS;EAC5B,OAAOiB,EAAE;AACV"}