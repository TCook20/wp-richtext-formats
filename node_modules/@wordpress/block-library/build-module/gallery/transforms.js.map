{"version":3,"names":["createBlock","createBlobURL","addFilter","LINK_DESTINATION_ATTACHMENT","LINK_DESTINATION_NONE","LINK_DESTINATION_MEDIA","DEPRECATED_LINK_DESTINATION_ATTACHMENT","DEPRECATED_LINK_DESTINATION_MEDIA","pickRelevantMediaFiles","isGalleryV2Enabled","parseShortcodeIds","ids","split","map","id","parseInt","updateThirdPartyTransformToGallery","block","name","attributes","images","length","innerBlocks","url","alt","sizeSlug","linkDestination","updateThirdPartyTransformFromGallery","toBlock","fromBlocks","from","Array","isArray","galleryBlock","find","transformedBlock","includes","transforms","type","isMultiBlock","blocks","transform","align","every","attribute","undefined","validImages","filter","image","width","height","caption","toString","tag","shortcode","named","columns","linkTo","link","imageIds","imageId","isMatch","priority","files","file","indexOf","to","title","href","rel","linkClass","imageSizeSlug","linkTarget","anchor","className","index"],"sources":["@wordpress/block-library/src/gallery/transforms.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\nimport { createBlobURL } from '@wordpress/blob';\nimport { addFilter } from '@wordpress/hooks';\n\n/**\n * Internal dependencies\n */\nimport {\n\tLINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_NONE,\n\tLINK_DESTINATION_MEDIA,\n} from './constants';\nimport {\n\tLINK_DESTINATION_ATTACHMENT as DEPRECATED_LINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_MEDIA as DEPRECATED_LINK_DESTINATION_MEDIA,\n} from './v1/constants';\nimport { pickRelevantMediaFiles, isGalleryV2Enabled } from './shared';\n\nconst parseShortcodeIds = ( ids ) => {\n\tif ( ! ids ) {\n\t\treturn [];\n\t}\n\n\treturn ids.split( ',' ).map( ( id ) => parseInt( id, 10 ) );\n};\n\n/**\n * Third party block plugins don't have an easy way to detect if the\n * innerBlocks version of the Gallery is running when they run a\n * 3rdPartyBlock -> GalleryBlock transform so this tranform filter\n * will handle this. Once the innerBlocks version is the default\n * in a core release, this could be deprecated and removed after\n * plugin authors have been given time to update transforms.\n *\n * @typedef  {Object} Attributes\n * @typedef  {Object} Block\n * @property {Attributes} attributes The attributes of the block.\n * @param    {Block}      block      The transformed block.\n * @return   {Block}                 The transformed block.\n */\nfunction updateThirdPartyTransformToGallery( block ) {\n\tif (\n\t\tisGalleryV2Enabled() &&\n\t\tblock.name === 'core/gallery' &&\n\t\tblock.attributes?.images.length > 0\n\t) {\n\t\tconst innerBlocks = block.attributes.images.map(\n\t\t\t( { url, id, alt } ) => {\n\t\t\t\treturn createBlock( 'core/image', {\n\t\t\t\t\turl,\n\t\t\t\t\tid: id ? parseInt( id, 10 ) : null,\n\t\t\t\t\talt,\n\t\t\t\t\tsizeSlug: block.attributes.sizeSlug,\n\t\t\t\t\tlinkDestination: block.attributes.linkDestination,\n\t\t\t\t} );\n\t\t\t}\n\t\t);\n\n\t\tdelete block.attributes.ids;\n\t\tdelete block.attributes.images;\n\t\tblock.innerBlocks = innerBlocks;\n\t}\n\n\treturn block;\n}\naddFilter(\n\t'blocks.switchToBlockType.transformedBlock',\n\t'core/gallery/update-third-party-transform-to',\n\tupdateThirdPartyTransformToGallery\n);\n\n/**\n * Third party block plugins don't have an easy way to detect if the\n * innerBlocks version of the Gallery is running when they run a\n * GalleryBlock -> 3rdPartyBlock transform so this transform filter\n * will handle this. Once the innerBlocks version is the default\n * in a core release, this could be deprecated and removed after\n * plugin authors have been given time to update transforms.\n *\n * @typedef  {Object} Attributes\n * @typedef  {Object} Block\n * @property {Attributes} attributes The attributes of the block.\n * @param    {Block}      toBlock    The block to transform to.\n * @param    {Block[]}    fromBlocks The blocks to transform from.\n * @return   {Block}                 The transformed block.\n */\nfunction updateThirdPartyTransformFromGallery( toBlock, fromBlocks ) {\n\tconst from = Array.isArray( fromBlocks ) ? fromBlocks : [ fromBlocks ];\n\tconst galleryBlock = from.find(\n\t\t( transformedBlock ) =>\n\t\t\ttransformedBlock.name === 'core/gallery' &&\n\t\t\ttransformedBlock.innerBlocks.length > 0 &&\n\t\t\t! transformedBlock.attributes.images?.length > 0 &&\n\t\t\t! toBlock.name.includes( 'core/' )\n\t);\n\n\tif ( galleryBlock ) {\n\t\tconst images = galleryBlock.innerBlocks.map(\n\t\t\t( { attributes: { url, id, alt } } ) => ( {\n\t\t\t\turl,\n\t\t\t\tid: id ? parseInt( id, 10 ) : null,\n\t\t\t\talt,\n\t\t\t} )\n\t\t);\n\t\tconst ids = images.map( ( { id } ) => id );\n\t\tgalleryBlock.attributes.images = images;\n\t\tgalleryBlock.attributes.ids = ids;\n\t}\n\n\treturn toBlock;\n}\naddFilter(\n\t'blocks.switchToBlockType.transformedBlock',\n\t'core/gallery/update-third-party-transform-from',\n\tupdateThirdPartyTransformFromGallery\n);\n\nconst transforms = {\n\tfrom: [\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tisMultiBlock: true,\n\t\t\tblocks: [ 'core/image' ],\n\t\t\ttransform: ( attributes ) => {\n\t\t\t\t// Init the align and size from the first item which may be either the placeholder or an image.\n\t\t\t\tlet { align, sizeSlug } = attributes[ 0 ];\n\t\t\t\t// Loop through all the images and check if they have the same align and size.\n\t\t\t\talign = attributes.every(\n\t\t\t\t\t( attribute ) => attribute.align === align\n\t\t\t\t)\n\t\t\t\t\t? align\n\t\t\t\t\t: undefined;\n\t\t\t\tsizeSlug = attributes.every(\n\t\t\t\t\t( attribute ) => attribute.sizeSlug === sizeSlug\n\t\t\t\t)\n\t\t\t\t\t? sizeSlug\n\t\t\t\t\t: undefined;\n\n\t\t\t\tconst validImages = attributes.filter( ( { url } ) => url );\n\n\t\t\t\tif ( isGalleryV2Enabled() ) {\n\t\t\t\t\tconst innerBlocks = validImages.map( ( image ) => {\n\t\t\t\t\t\t// Gallery images can't currently be resized so make sure height and width are undefined.\n\t\t\t\t\t\timage.width = undefined;\n\t\t\t\t\t\timage.height = undefined;\n\t\t\t\t\t\treturn createBlock( 'core/image', image );\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn createBlock(\n\t\t\t\t\t\t'core/gallery',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\talign,\n\t\t\t\t\t\t\tsizeSlug,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tinnerBlocks\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn createBlock( 'core/gallery', {\n\t\t\t\t\timages: validImages.map(\n\t\t\t\t\t\t( { id, url, alt, caption } ) => ( {\n\t\t\t\t\t\t\tid: id.toString(),\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\talt,\n\t\t\t\t\t\t\tcaption,\n\t\t\t\t\t\t} )\n\t\t\t\t\t),\n\t\t\t\t\tids: validImages.map( ( { id } ) => parseInt( id, 10 ) ),\n\t\t\t\t\talign,\n\t\t\t\t\tsizeSlug,\n\t\t\t\t} );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: 'shortcode',\n\t\t\ttag: 'gallery',\n\n\t\t\tattributes: {\n\t\t\t\timages: {\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\tshortcode: ( { named: { ids } } ) => {\n\t\t\t\t\t\tif ( ! isGalleryV2Enabled() ) {\n\t\t\t\t\t\t\treturn parseShortcodeIds( ids ).map( ( id ) => ( {\n\t\t\t\t\t\t\t\tid: id.toString(),\n\t\t\t\t\t\t\t} ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tids: {\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\tshortcode: ( { named: { ids } } ) => {\n\t\t\t\t\t\tif ( ! isGalleryV2Enabled() ) {\n\t\t\t\t\t\t\treturn parseShortcodeIds( ids );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcolumns: {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tshortcode: ( { named: { columns = '3' } } ) => {\n\t\t\t\t\t\treturn parseInt( columns, 10 );\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tlinkTo: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tshortcode: ( { named: { link } } ) => {\n\t\t\t\t\t\tif ( ! isGalleryV2Enabled() ) {\n\t\t\t\t\t\t\tswitch ( link ) {\n\t\t\t\t\t\t\t\tcase 'post':\n\t\t\t\t\t\t\t\t\treturn DEPRECATED_LINK_DESTINATION_ATTACHMENT;\n\t\t\t\t\t\t\t\tcase 'file':\n\t\t\t\t\t\t\t\t\treturn DEPRECATED_LINK_DESTINATION_MEDIA;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\treturn DEPRECATED_LINK_DESTINATION_ATTACHMENT;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch ( link ) {\n\t\t\t\t\t\t\tcase 'post':\n\t\t\t\t\t\t\t\treturn LINK_DESTINATION_ATTACHMENT;\n\t\t\t\t\t\t\tcase 'file':\n\t\t\t\t\t\t\t\treturn LINK_DESTINATION_MEDIA;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\treturn LINK_DESTINATION_NONE;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\ttransform( { named: { ids, columns = 3, link } } ) {\n\t\t\t\tconst imageIds = parseShortcodeIds( ids ).map( ( id ) =>\n\t\t\t\t\tparseInt( id, 10 )\n\t\t\t\t);\n\n\t\t\t\tlet linkTo = LINK_DESTINATION_NONE;\n\t\t\t\tif ( link === 'post' ) {\n\t\t\t\t\tlinkTo = LINK_DESTINATION_ATTACHMENT;\n\t\t\t\t} else if ( link === 'file' ) {\n\t\t\t\t\tlinkTo = LINK_DESTINATION_MEDIA;\n\t\t\t\t}\n\n\t\t\t\tconst galleryBlock = createBlock(\n\t\t\t\t\t'core/gallery',\n\t\t\t\t\t{\n\t\t\t\t\t\tcolumns: parseInt( columns, 10 ),\n\t\t\t\t\t\tlinkTo,\n\t\t\t\t\t},\n\t\t\t\t\timageIds.map( ( imageId ) =>\n\t\t\t\t\t\tcreateBlock( 'core/image', { id: imageId } )\n\t\t\t\t\t)\n\t\t\t\t);\n\n\t\t\t\treturn galleryBlock;\n\t\t\t},\n\t\t\tisMatch( { named } ) {\n\t\t\t\treturn undefined !== named.ids;\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\t// When created by drag and dropping multiple files on an insertion point. Because multiple\n\t\t\t// files must not be transformed to a gallery when dropped within a gallery there is another transform\n\t\t\t// within the image block to handle that case. Therefore this transform has to have priority 1\n\t\t\t// set so that it overrrides the image block transformation when mulitple images are dropped outside\n\t\t\t// of a gallery block.\n\t\t\ttype: 'files',\n\t\t\tpriority: 1,\n\t\t\tisMatch( files ) {\n\t\t\t\treturn (\n\t\t\t\t\tfiles.length !== 1 &&\n\t\t\t\t\tfiles.every(\n\t\t\t\t\t\t( file ) => file.type.indexOf( 'image/' ) === 0\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t},\n\t\t\ttransform( files ) {\n\t\t\t\tif ( isGalleryV2Enabled() ) {\n\t\t\t\t\tconst innerBlocks = files.map( ( file ) =>\n\t\t\t\t\t\tcreateBlock( 'core/image', {\n\t\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\n\t\t\t\t\treturn createBlock( 'core/gallery', {}, innerBlocks );\n\t\t\t\t}\n\t\t\t\tconst block = createBlock( 'core/gallery', {\n\t\t\t\t\timages: files.map( ( file ) =>\n\t\t\t\t\t\tpickRelevantMediaFiles( {\n\t\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t\t} )\n\t\t\t\t\t),\n\t\t\t\t} );\n\t\t\t\treturn block;\n\t\t\t},\n\t\t},\n\t],\n\tto: [\n\t\t{\n\t\t\ttype: 'block',\n\t\t\tblocks: [ 'core/image' ],\n\t\t\ttransform: ( { align, images, ids, sizeSlug }, innerBlocks ) => {\n\t\t\t\tif ( isGalleryV2Enabled() ) {\n\t\t\t\t\tif ( innerBlocks.length > 0 ) {\n\t\t\t\t\t\treturn innerBlocks.map(\n\t\t\t\t\t\t\t( {\n\t\t\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\t\talt,\n\t\t\t\t\t\t\t\t\tcaption,\n\t\t\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\t\t\thref,\n\t\t\t\t\t\t\t\t\trel,\n\t\t\t\t\t\t\t\t\tlinkClass,\n\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\tsizeSlug: imageSizeSlug,\n\t\t\t\t\t\t\t\t\tlinkDestination,\n\t\t\t\t\t\t\t\t\tlinkTarget,\n\t\t\t\t\t\t\t\t\tanchor,\n\t\t\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} ) =>\n\t\t\t\t\t\t\t\tcreateBlock( 'core/image', {\n\t\t\t\t\t\t\t\t\talign,\n\t\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\t\talt,\n\t\t\t\t\t\t\t\t\tcaption,\n\t\t\t\t\t\t\t\t\ttitle,\n\t\t\t\t\t\t\t\t\thref,\n\t\t\t\t\t\t\t\t\trel,\n\t\t\t\t\t\t\t\t\tlinkClass,\n\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\tsizeSlug: imageSizeSlug,\n\t\t\t\t\t\t\t\t\tlinkDestination,\n\t\t\t\t\t\t\t\t\tlinkTarget,\n\t\t\t\t\t\t\t\t\tanchor,\n\t\t\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn createBlock( 'core/image', { align } );\n\t\t\t\t}\n\t\t\t\tif ( images.length > 0 ) {\n\t\t\t\t\treturn images.map( ( { url, alt, caption }, index ) =>\n\t\t\t\t\t\tcreateBlock( 'core/image', {\n\t\t\t\t\t\t\tid: ids[ index ],\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\talt,\n\t\t\t\t\t\t\tcaption,\n\t\t\t\t\t\t\talign,\n\t\t\t\t\t\t\tsizeSlug,\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn createBlock( 'core/image', { align } );\n\t\t\t},\n\t\t},\n\t],\n};\n\nexport default transforms;\n"],"mappings":"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"}