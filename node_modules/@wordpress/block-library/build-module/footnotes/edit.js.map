{"version":3,"names":["BlockIcon","RichText","useBlockProps","useEntityProp","__","Placeholder","formatListNumbered","icon","FootnotesEdit","context","postType","postId","meta","updateMeta","footnotes","JSON","parse","blockProps","createElement","label","length","instructions","map","id","content","key","tagName","value","identifier","onFocus","event","target","textContent","trim","scrollIntoView","onChange","nextFootnote","stringify","footnote","href"],"sources":["@wordpress/block-library/src/footnotes/edit.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { BlockIcon, RichText, useBlockProps } from '@wordpress/block-editor';\nimport { useEntityProp } from '@wordpress/core-data';\nimport { __ } from '@wordpress/i18n';\nimport { Placeholder } from '@wordpress/components';\nimport { formatListNumbered as icon } from '@wordpress/icons';\n\nexport default function FootnotesEdit( { context: { postType, postId } } ) {\n\tconst [ meta, updateMeta ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'meta',\n\t\tpostId\n\t);\n\tconst footnotes = meta?.footnotes ? JSON.parse( meta.footnotes ) : [];\n\tconst blockProps = useBlockProps();\n\n\tif ( postType !== 'post' && postType !== 'page' ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\n\t\t\t\t\t// To do: add instructions. We can't add new string in RC.\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( ! footnotes.length ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\n\t\t\t\t\tinstructions={ __(\n\t\t\t\t\t\t'Footnotes found in blocks within this document will be displayed here.'\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<ol { ...blockProps }>\n\t\t\t{ footnotes.map( ( { id, content } ) => (\n\t\t\t\t<li key={ id }>\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tid={ id }\n\t\t\t\t\t\ttagName=\"span\"\n\t\t\t\t\t\tvalue={ content }\n\t\t\t\t\t\tidentifier={ id }\n\t\t\t\t\t\t// To do: figure out why the browser is not scrolling\n\t\t\t\t\t\t// into view when it receives focus.\n\t\t\t\t\t\tonFocus={ ( event ) => {\n\t\t\t\t\t\t\tif ( ! event.target.textContent.trim() ) {\n\t\t\t\t\t\t\t\tevent.target.scrollIntoView();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonChange={ ( nextFootnote ) => {\n\t\t\t\t\t\t\tupdateMeta( {\n\t\t\t\t\t\t\t\t...meta,\n\t\t\t\t\t\t\t\tfootnotes: JSON.stringify(\n\t\t\t\t\t\t\t\t\tfootnotes.map( ( footnote ) => {\n\t\t\t\t\t\t\t\t\t\treturn footnote.id === id\n\t\t\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: nextFootnote,\n\t\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t\t\t: footnote;\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>{ ' ' }\n\t\t\t\t\t<a href={ `#${ id }-link` }>↩︎</a>\n\t\t\t\t</li>\n\t\t\t) ) }\n\t\t</ol>\n\t);\n}\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,QAAQ,EAAEC,aAAa,QAAQ,yBAAyB;AAC5E,SAASC,aAAa,QAAQ,sBAAsB;AACpD,SAASC,EAAE,QAAQ,iBAAiB;AACpC,SAASC,WAAW,QAAQ,uBAAuB;AACnD,SAASC,kBAAkB,IAAIC,IAAI,QAAQ,kBAAkB;AAE7D,eAAe,SAASC,aAAaA,CAAE;EAAEC,OAAO,EAAE;IAAEC,QAAQ;IAAEC;EAAO;AAAE,CAAC,EAAG;EAC1E,MAAM,CAAEC,IAAI,EAAEC,UAAU,CAAE,GAAGV,aAAa,CACzC,UAAU,EACVO,QAAQ,EACR,MAAM,EACNC,MACD,CAAC;EACD,MAAMG,SAAS,GAAGF,IAAI,EAAEE,SAAS,GAAGC,IAAI,CAACC,KAAK,CAAEJ,IAAI,CAACE,SAAU,CAAC,GAAG,EAAE;EACrE,MAAMG,UAAU,GAAGf,aAAa,CAAC,CAAC;EAElC,IAAKQ,QAAQ,KAAK,MAAM,IAAIA,QAAQ,KAAK,MAAM,EAAG;IACjD,OACCQ,aAAA;MAAA,GAAUD;IAAU,GACnBC,aAAA,CAACb,WAAW;MACXE,IAAI,EAAGW,aAAA,CAAClB,SAAS;QAACO,IAAI,EAAGA;MAAM,CAAE,CAAG;MACpCY,KAAK,EAAGf,EAAE,CAAE,WAAY;MACxB;IAAA,CACA,CACG,CAAC;EAER;;EAEA,IAAK,CAAEU,SAAS,CAACM,MAAM,EAAG;IACzB,OACCF,aAAA;MAAA,GAAUD;IAAU,GACnBC,aAAA,CAACb,WAAW;MACXE,IAAI,EAAGW,aAAA,CAAClB,SAAS;QAACO,IAAI,EAAGA;MAAM,CAAE,CAAG;MACpCY,KAAK,EAAGf,EAAE,CAAE,WAAY,CAAG;MAC3BiB,YAAY,EAAGjB,EAAE,CAChB,wEACD;IAAG,CACH,CACG,CAAC;EAER;EAEA,OACCc,aAAA;IAAA,GAASD;EAAU,GAChBH,SAAS,CAACQ,GAAG,CAAE,CAAE;IAAEC,EAAE;IAAEC;EAAQ,CAAC,KACjCN,aAAA;IAAIO,GAAG,EAAGF;EAAI,GACbL,aAAA,CAACjB,QAAQ;IACRsB,EAAE,EAAGA,EAAI;IACTG,OAAO,EAAC,MAAM;IACdC,KAAK,EAAGH,OAAS;IACjBI,UAAU,EAAGL;IACb;IACA;IAAA;IACAM,OAAO,EAAKC,KAAK,IAAM;MACtB,IAAK,CAAEA,KAAK,CAACC,MAAM,CAACC,WAAW,CAACC,IAAI,CAAC,CAAC,EAAG;QACxCH,KAAK,CAACC,MAAM,CAACG,cAAc,CAAC,CAAC;MAC9B;IACD,CAAG;IACHC,QAAQ,EAAKC,YAAY,IAAM;MAC9BvB,UAAU,CAAE;QACX,GAAGD,IAAI;QACPE,SAAS,EAAEC,IAAI,CAACsB,SAAS,CACxBvB,SAAS,CAACQ,GAAG,CAAIgB,QAAQ,IAAM;UAC9B,OAAOA,QAAQ,CAACf,EAAE,KAAKA,EAAE,GACtB;YACAC,OAAO,EAAEY,YAAY;YACrBb;UACA,CAAC,GACDe,QAAQ;QACZ,CAAE,CACH;MACD,CAAE,CAAC;IACJ;EAAG,CACH,CAAC,EAAE,GAAG,EACPpB,aAAA;IAAGqB,IAAI,EAAI,IAAIhB,EAAI;EAAQ,GAAC,cAAK,CAC9B,CACH,CACC,CAAC;AAEP"}