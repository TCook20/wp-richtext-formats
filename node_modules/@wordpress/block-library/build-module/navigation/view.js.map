{"version":3,"names":["hasOpenSubmenu","closeSubmenus","navigationItem","querySelectorAll","forEach","toggle","setAttribute","toggleSubmenuOnClick","buttonToggle","isSubmenuOpen","getAttribute","closest","navigationParent","child","document","addEventListener","event","target","button","navigationBlocks","block","contains","HTMLButtonElement","passive","submenuBlocks","key","querySelector","focus"],"sources":["@wordpress/block-library/src/navigation/view.js"],"sourcesContent":["/*eslint-env browser*/\n// Open on click functionality.\n\n/**\n * Keep track of whether a submenu is open to short-circuit delegated event listeners.\n *\n * @type {boolean}\n */\nlet hasOpenSubmenu = false;\n\n/**\n * Close submenu items for a navigation item.\n *\n * @param {HTMLElement} navigationItem - Either a NAV or LI element.\n */\nfunction closeSubmenus( navigationItem ) {\n\tnavigationItem\n\t\t.querySelectorAll( '[aria-expanded=\"true\"]' )\n\t\t.forEach( function ( toggle ) {\n\t\t\ttoggle.setAttribute( 'aria-expanded', 'false' );\n\t\t} );\n\thasOpenSubmenu = false;\n}\n\n/**\n * Toggle submenu on click.\n *\n * @param {HTMLButtonElement} buttonToggle\n */\nfunction toggleSubmenuOnClick( buttonToggle ) {\n\tconst isSubmenuOpen =\n\t\tbuttonToggle.getAttribute( 'aria-expanded' ) === 'true';\n\tconst navigationItem = buttonToggle.closest( '.wp-block-navigation-item' );\n\n\tif ( isSubmenuOpen ) {\n\t\tcloseSubmenus( navigationItem );\n\t} else {\n\t\t// Close all sibling submenus.\n\t\tconst navigationParent = buttonToggle.closest(\n\t\t\t'.wp-block-navigation__submenu-container, .wp-block-navigation__container, .wp-block-page-list'\n\t\t);\n\t\tnavigationParent\n\t\t\t.querySelectorAll( '.wp-block-navigation-item' )\n\t\t\t.forEach( ( child ) => {\n\t\t\t\tif ( child !== navigationItem ) {\n\t\t\t\t\tcloseSubmenus( child );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t// Open submenu.\n\t\tbuttonToggle.setAttribute( 'aria-expanded', 'true' );\n\t\thasOpenSubmenu = true;\n\t}\n}\n\n// Open on button click or close on click outside.\ndocument.addEventListener(\n\t'click',\n\tfunction ( event ) {\n\t\tconst target = event.target;\n\t\tconst button = target.closest( '.wp-block-navigation-submenu__toggle' );\n\n\t\t// Close any other open submenus.\n\t\tif ( hasOpenSubmenu ) {\n\t\t\tconst navigationBlocks = document.querySelectorAll(\n\t\t\t\t'.wp-block-navigation'\n\t\t\t);\n\t\t\tnavigationBlocks.forEach( function ( block ) {\n\t\t\t\tif ( ! block.contains( target ) ) {\n\t\t\t\t\tcloseSubmenus( block );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Now open the submenu if one was clicked.\n\t\tif ( button instanceof HTMLButtonElement ) {\n\t\t\ttoggleSubmenuOnClick( button );\n\t\t}\n\t},\n\t{ passive: true }\n);\n\n// Close on focus outside or escape key.\ndocument.addEventListener(\n\t'keyup',\n\tfunction ( event ) {\n\t\t// Abort if there aren't any submenus open anyway.\n\t\tif ( ! hasOpenSubmenu ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst submenuBlocks = document.querySelectorAll(\n\t\t\t'.wp-block-navigation-item.has-child'\n\t\t);\n\t\tsubmenuBlocks.forEach( function ( block ) {\n\t\t\tif ( ! block.contains( event.target ) ) {\n\t\t\t\tcloseSubmenus( block );\n\t\t\t} else if ( event.key === 'Escape' ) {\n\t\t\t\tconst toggle = block.querySelector( '[aria-expanded=\"true\"]' );\n\t\t\t\tcloseSubmenus( block );\n\t\t\t\t// Focus the submenu trigger so focus does not get trapped in the closed submenu.\n\t\t\t\ttoggle?.focus();\n\t\t\t}\n\t\t} );\n\t},\n\t{ passive: true }\n);\n"],"mappings":"AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAIA,cAAc,GAAG,KAAK;;AAE1B;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAAEC,cAAc,EAAG;EACxCA,cAAc,CACZC,gBAAgB,CAAE,wBAAyB,CAAC,CAC5CC,OAAO,CAAE,UAAWC,MAAM,EAAG;IAC7BA,MAAM,CAACC,YAAY,CAAE,eAAe,EAAE,OAAQ,CAAC;EAChD,CAAE,CAAC;EACJN,cAAc,GAAG,KAAK;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASO,oBAAoBA,CAAEC,YAAY,EAAG;EAC7C,MAAMC,aAAa,GAClBD,YAAY,CAACE,YAAY,CAAE,eAAgB,CAAC,KAAK,MAAM;EACxD,MAAMR,cAAc,GAAGM,YAAY,CAACG,OAAO,CAAE,2BAA4B,CAAC;EAE1E,IAAKF,aAAa,EAAG;IACpBR,aAAa,CAAEC,cAAe,CAAC;EAChC,CAAC,MAAM;IACN;IACA,MAAMU,gBAAgB,GAAGJ,YAAY,CAACG,OAAO,CAC5C,+FACD,CAAC;IACDC,gBAAgB,CACdT,gBAAgB,CAAE,2BAA4B,CAAC,CAC/CC,OAAO,CAAIS,KAAK,IAAM;MACtB,IAAKA,KAAK,KAAKX,cAAc,EAAG;QAC/BD,aAAa,CAAEY,KAAM,CAAC;MACvB;IACD,CAAE,CAAC;;IAEJ;IACAL,YAAY,CAACF,YAAY,CAAE,eAAe,EAAE,MAAO,CAAC;IACpDN,cAAc,GAAG,IAAI;EACtB;AACD;;AAEA;AACAc,QAAQ,CAACC,gBAAgB,CACxB,OAAO,EACP,UAAWC,KAAK,EAAG;EAClB,MAAMC,MAAM,GAAGD,KAAK,CAACC,MAAM;EAC3B,MAAMC,MAAM,GAAGD,MAAM,CAACN,OAAO,CAAE,sCAAuC,CAAC;;EAEvE;EACA,IAAKX,cAAc,EAAG;IACrB,MAAMmB,gBAAgB,GAAGL,QAAQ,CAACX,gBAAgB,CACjD,sBACD,CAAC;IACDgB,gBAAgB,CAACf,OAAO,CAAE,UAAWgB,KAAK,EAAG;MAC5C,IAAK,CAAEA,KAAK,CAACC,QAAQ,CAAEJ,MAAO,CAAC,EAAG;QACjChB,aAAa,CAAEmB,KAAM,CAAC;MACvB;IACD,CAAE,CAAC;EACJ;;EAEA;EACA,IAAKF,MAAM,YAAYI,iBAAiB,EAAG;IAC1Cf,oBAAoB,CAAEW,MAAO,CAAC;EAC/B;AACD,CAAC,EACD;EAAEK,OAAO,EAAE;AAAK,CACjB,CAAC;;AAED;AACAT,QAAQ,CAACC,gBAAgB,CACxB,OAAO,EACP,UAAWC,KAAK,EAAG;EAClB;EACA,IAAK,CAAEhB,cAAc,EAAG;IACvB;EACD;EAEA,MAAMwB,aAAa,GAAGV,QAAQ,CAACX,gBAAgB,CAC9C,qCACD,CAAC;EACDqB,aAAa,CAACpB,OAAO,CAAE,UAAWgB,KAAK,EAAG;IACzC,IAAK,CAAEA,KAAK,CAACC,QAAQ,CAAEL,KAAK,CAACC,MAAO,CAAC,EAAG;MACvChB,aAAa,CAAEmB,KAAM,CAAC;IACvB,CAAC,MAAM,IAAKJ,KAAK,CAACS,GAAG,KAAK,QAAQ,EAAG;MACpC,MAAMpB,MAAM,GAAGe,KAAK,CAACM,aAAa,CAAE,wBAAyB,CAAC;MAC9DzB,aAAa,CAAEmB,KAAM,CAAC;MACtB;MACAf,MAAM,EAAEsB,KAAK,CAAC,CAAC;IAChB;EACD,CAAE,CAAC;AACJ,CAAC,EACD;EAAEJ,OAAO,EAAE;AAAK,CACjB,CAAC"}