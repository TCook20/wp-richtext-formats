{"version":3,"names":["_element","require","_classnames","_interopRequireDefault","_compose","_components","_blockEditor","_i18n","_data","_viewport","_primitives","_blocks","_blob","_notices","_icons","_sharedIcon","_shared","_utils","_utils2","_gallery","_constants","_useImageSizes","_useGetNewImages","_useGetMedia","_gapStyles","MAX_COLUMNS","linkOptions","value","LINK_DESTINATION_ATTACHMENT","label","__","LINK_DESTINATION_MEDIA","LINK_DESTINATION_NONE","_x","ALLOWED_MEDIA_TYPES","allowedBlocks","PLACEHOLDER_TEXT","Platform","isNative","MOBILE_CONTROL_PROPS_RANGE_CONTROL","type","GalleryEdit","props","setAttributes","attributes","className","clientId","isSelected","insertBlocksAfter","isContentLocked","onFocus","columns","imageCrop","linkTarget","linkTo","sizeSlug","caption","showCaption","setShowCaption","useState","prevCaption","usePrevious","useEffect","captionRef","useCallback","node","focus","__unstableMarkNextChangeAsNotPersistent","replaceInnerBlocks","updateBlockAttributes","selectBlock","useDispatch","blockEditorStore","createSuccessNotice","createErrorNotice","noticesStore","getBlock","getSettings","preferredStyle","useSelect","select","settings","preferredStyleVariations","__experimentalPreferredStyleVariations","innerBlockImages","_select$getBlock$inne","innerBlocks","wasBlockJustInserted","images","useMemo","map","block","id","url","fromSavedContent","Boolean","originalContent","imageData","useGetMedia","newImages","useGetNewImages","forEach","newImage","buildImageAttributes","align","undefined","imageSizeOptions","useImageSizes","imageAttributes","image","find","newClassName","newLinkTarget","rel","getUpdatedLinkTargetSettings","pickRelevantMediaFiles","getHrefAndDestination","linkDestination","raw","alt","alt_text","isValidFileType","file","nativeFileData","mediaTypeSelector","media_type","some","mediaType","indexOf","updateImages","selectedImages","newFileUploads","Object","prototype","toString","call","imageArray","Array","from","createBlobURL","every","processedImages","filter","newOrderMap","reduce","result","index","existingImageBlocks","img","newImageList","existingImg","newBlocks","createBlock","concat","sort","a","b","length","onUploadError","message","setLinkTo","changedAttributes","blocks","push","linkToText","linkType","sprintf","setColumnsNumber","toggleImageCrop","getImageCropHelp","checked","toggleOpenInNewTab","openInNewTab","noticeText","updateImagesSize","newSizeSlug","getImageSizeAttributes","imageSize","size","window","wp","media","view","defaultProps","link","hasImages","hasImageIds","imagesUploading","mediaPlaceholderProps","web","addToGallery","disableMediaButtons","native","isAppender","autoOpenMediaUpload","mediaPlaceholder","createElement","MediaPlaceholder","handleUpload","icon","sharedIcon","labels","title","instructions","onSelect","accept","allowedTypes","multiple","onError","blockProps","useBlockProps","classnames","nativeInnerBlockProps","marginHorizontal","marginVertical","innerBlocksProps","useInnerBlocksProps","orientation","renderAppender","View","children","hasLinkTo","Fragment","InspectorControls","PanelBody","RangeControl","__nextHasNoMarginBottom","defaultColumnsNumber","onChange","min","max","Math","required","__next40pxDefaultSize","ToggleControl","help","SelectControl","options","hideCancelButton","isWeb","BaseControl","VisualLabel","Spinner","BlockControls","group","ToolbarButton","onClick","captionIcon","isPressed","MediaReplaceFlow","name","mediaIds","default","blockGap","style","spacing","ref","_default","compose","withViewportMatch","isNarrow","exports"],"sources":["@wordpress/block-library/src/gallery/edit.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { compose, usePrevious } from '@wordpress/compose';\nimport {\n\tBaseControl,\n\tPanelBody,\n\tSelectControl,\n\tToggleControl,\n\tRangeControl,\n\tSpinner,\n\tToolbarButton,\n} from '@wordpress/components';\nimport {\n\tstore as blockEditorStore,\n\tMediaPlaceholder,\n\tInspectorControls,\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\tBlockControls,\n\tMediaReplaceFlow,\n} from '@wordpress/block-editor';\nimport {\n\tPlatform,\n\tuseCallback,\n\tuseEffect,\n\tuseState,\n\tuseMemo,\n} from '@wordpress/element';\nimport { __, _x, sprintf } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { withViewportMatch } from '@wordpress/viewport';\nimport { View } from '@wordpress/primitives';\nimport { createBlock } from '@wordpress/blocks';\nimport { createBlobURL } from '@wordpress/blob';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { caption as captionIcon } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport { sharedIcon } from './shared-icon';\nimport { defaultColumnsNumber, pickRelevantMediaFiles } from './shared';\nimport { getHrefAndDestination } from './utils';\nimport {\n\tgetUpdatedLinkTargetSettings,\n\tgetImageSizeAttributes,\n} from '../image/utils';\nimport Gallery from './gallery';\nimport {\n\tLINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_MEDIA,\n\tLINK_DESTINATION_NONE,\n} from './constants';\nimport useImageSizes from './use-image-sizes';\nimport useGetNewImages from './use-get-new-images';\nimport useGetMedia from './use-get-media';\nimport GapStyles from './gap-styles';\n\nconst MAX_COLUMNS = 8;\nconst linkOptions = [\n\t{ value: LINK_DESTINATION_ATTACHMENT, label: __( 'Attachment Page' ) },\n\t{ value: LINK_DESTINATION_MEDIA, label: __( 'Media File' ) },\n\t{\n\t\tvalue: LINK_DESTINATION_NONE,\n\t\tlabel: _x( 'None', 'Media item link option' ),\n\t},\n];\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\nconst allowedBlocks = [ 'core/image' ];\n\nconst PLACEHOLDER_TEXT = Platform.isNative\n\t? __( 'ADD MEDIA' )\n\t: __( 'Drag images, upload new ones or select files from your library.' );\n\nconst MOBILE_CONTROL_PROPS_RANGE_CONTROL = Platform.isNative\n\t? { type: 'stepper' }\n\t: {};\n\nfunction GalleryEdit( props ) {\n\tconst {\n\t\tsetAttributes,\n\t\tattributes,\n\t\tclassName,\n\t\tclientId,\n\t\tisSelected,\n\t\tinsertBlocksAfter,\n\t\tisContentLocked,\n\t\tonFocus,\n\t} = props;\n\n\tconst { columns, imageCrop, linkTarget, linkTo, sizeSlug, caption } =\n\t\tattributes;\n\tconst [ showCaption, setShowCaption ] = useState( !! caption );\n\tconst prevCaption = usePrevious( caption );\n\n\t// We need to show the caption when changes come from\n\t// history navigation(undo/redo).\n\tuseEffect( () => {\n\t\tif ( caption && ! prevCaption ) {\n\t\t\tsetShowCaption( true );\n\t\t}\n\t}, [ caption, prevCaption ] );\n\n\tuseEffect( () => {\n\t\tif ( ! isSelected && ! caption ) {\n\t\t\tsetShowCaption( false );\n\t\t}\n\t}, [ isSelected, caption ] );\n\n\t// Focus the caption when we click to add one.\n\tconst captionRef = useCallback(\n\t\t( node ) => {\n\t\t\tif ( node && ! caption ) {\n\t\t\t\tnode.focus();\n\t\t\t}\n\t\t},\n\t\t[ caption ]\n\t);\n\n\tconst {\n\t\t__unstableMarkNextChangeAsNotPersistent,\n\t\treplaceInnerBlocks,\n\t\tupdateBlockAttributes,\n\t\tselectBlock,\n\t} = useDispatch( blockEditorStore );\n\tconst { createSuccessNotice, createErrorNotice } =\n\t\tuseDispatch( noticesStore );\n\n\tconst { getBlock, getSettings, preferredStyle } = useSelect( ( select ) => {\n\t\tconst settings = select( blockEditorStore ).getSettings();\n\t\tconst preferredStyleVariations =\n\t\t\tsettings.__experimentalPreferredStyleVariations;\n\t\treturn {\n\t\t\tgetBlock: select( blockEditorStore ).getBlock,\n\t\t\tgetSettings: select( blockEditorStore ).getSettings,\n\t\t\tpreferredStyle: preferredStyleVariations?.value?.[ 'core/image' ],\n\t\t};\n\t}, [] );\n\n\tconst innerBlockImages = useSelect(\n\t\t( select ) => {\n\t\t\tconst innerBlocks =\n\t\t\t\tselect( blockEditorStore ).getBlock( clientId )?.innerBlocks ??\n\t\t\t\t[];\n\t\t\treturn innerBlocks;\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst wasBlockJustInserted = useSelect(\n\t\t( select ) => {\n\t\t\treturn select( blockEditorStore ).wasBlockJustInserted(\n\t\t\t\tclientId,\n\t\t\t\t'inserter_menu'\n\t\t\t);\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst images = useMemo(\n\t\t() =>\n\t\t\tinnerBlockImages?.map( ( block ) => ( {\n\t\t\t\tclientId: block.clientId,\n\t\t\t\tid: block.attributes.id,\n\t\t\t\turl: block.attributes.url,\n\t\t\t\tattributes: block.attributes,\n\t\t\t\tfromSavedContent: Boolean( block.originalContent ),\n\t\t\t} ) ),\n\t\t[ innerBlockImages ]\n\t);\n\n\tconst imageData = useGetMedia( innerBlockImages );\n\n\tconst newImages = useGetNewImages( images, imageData );\n\n\tuseEffect( () => {\n\t\tnewImages?.forEach( ( newImage ) => {\n\t\t\t// Update the images data without creating new undo levels.\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\n\t\t\tupdateBlockAttributes( newImage.clientId, {\n\t\t\t\t...buildImageAttributes( newImage.attributes ),\n\t\t\t\tid: newImage.id,\n\t\t\t\talign: undefined,\n\t\t\t} );\n\t\t} );\n\t}, [ newImages ] );\n\n\tconst imageSizeOptions = useImageSizes(\n\t\timageData,\n\t\tisSelected,\n\t\tgetSettings\n\t);\n\n\t/**\n\t * Determines the image attributes that should be applied to an image block\n\t * after the gallery updates.\n\t *\n\t * The gallery will receive the full collection of images when a new image\n\t * is added. As a result we need to reapply the image's original settings if\n\t * it already existed in the gallery. If the image is in fact new, we need\n\t * to apply the gallery's current settings to the image.\n\t *\n\t * @param {Object} imageAttributes Media object for the actual image.\n\t * @return {Object}                Attributes to set on the new image block.\n\t */\n\tfunction buildImageAttributes( imageAttributes ) {\n\t\tconst image = imageAttributes.id\n\t\t\t? imageData.find( ( { id } ) => id === imageAttributes.id )\n\t\t\t: null;\n\n\t\tlet newClassName;\n\t\tif ( imageAttributes.className && imageAttributes.className !== '' ) {\n\t\t\tnewClassName = imageAttributes.className;\n\t\t} else {\n\t\t\tnewClassName = preferredStyle\n\t\t\t\t? `is-style-${ preferredStyle }`\n\t\t\t\t: undefined;\n\t\t}\n\n\t\tlet newLinkTarget;\n\t\tif ( imageAttributes.linkTarget || imageAttributes.rel ) {\n\t\t\t// When transformed from image blocks, the link destination and rel attributes are inherited.\n\t\t\tnewLinkTarget = {\n\t\t\t\tlinkTarget: imageAttributes.linkTarget,\n\t\t\t\trel: imageAttributes.rel,\n\t\t\t};\n\t\t} else {\n\t\t\t// When an image is added, update the link destination and rel attributes according to the gallery settings\n\t\t\tnewLinkTarget = getUpdatedLinkTargetSettings(\n\t\t\t\tlinkTarget,\n\t\t\t\tattributes\n\t\t\t);\n\t\t}\n\n\t\treturn {\n\t\t\t...pickRelevantMediaFiles( image, sizeSlug ),\n\t\t\t...getHrefAndDestination(\n\t\t\t\timage,\n\t\t\t\tlinkTo,\n\t\t\t\timageAttributes?.linkDestination\n\t\t\t),\n\t\t\t...newLinkTarget,\n\t\t\tclassName: newClassName,\n\t\t\tsizeSlug,\n\t\t\tcaption: imageAttributes.caption || image.caption?.raw,\n\t\t\talt: imageAttributes.alt || image.alt_text,\n\t\t};\n\t}\n\n\tfunction isValidFileType( file ) {\n\t\t// It's necessary to retrieve the media type from the raw image data for already-uploaded images on native.\n\t\tconst nativeFileData =\n\t\t\tPlatform.isNative && file.id\n\t\t\t\t? imageData.find( ( { id } ) => id === file.id )\n\t\t\t\t: null;\n\n\t\tconst mediaTypeSelector = nativeFileData\n\t\t\t? nativeFileData?.media_type\n\t\t\t: file.type;\n\n\t\treturn (\n\t\t\tALLOWED_MEDIA_TYPES.some(\n\t\t\t\t( mediaType ) => mediaTypeSelector?.indexOf( mediaType ) === 0\n\t\t\t) || file.url?.indexOf( 'blob:' ) === 0\n\t\t);\n\t}\n\n\tfunction updateImages( selectedImages ) {\n\t\tconst newFileUploads =\n\t\t\tObject.prototype.toString.call( selectedImages ) ===\n\t\t\t'[object FileList]';\n\n\t\tconst imageArray = newFileUploads\n\t\t\t? Array.from( selectedImages ).map( ( file ) => {\n\t\t\t\t\tif ( ! file.url ) {\n\t\t\t\t\t\treturn pickRelevantMediaFiles( {\n\t\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn file;\n\t\t\t  } )\n\t\t\t: selectedImages;\n\n\t\tif ( ! imageArray.every( isValidFileType ) ) {\n\t\t\tcreateErrorNotice(\n\t\t\t\t__(\n\t\t\t\t\t'If uploading to a gallery all files need to be image formats'\n\t\t\t\t),\n\t\t\t\t{ id: 'gallery-upload-invalid-file', type: 'snackbar' }\n\t\t\t);\n\t\t}\n\n\t\tconst processedImages = imageArray\n\t\t\t.filter( ( file ) => file.url || isValidFileType( file ) )\n\t\t\t.map( ( file ) => {\n\t\t\t\tif ( ! file.url ) {\n\t\t\t\t\treturn pickRelevantMediaFiles( {\n\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\treturn file;\n\t\t\t} );\n\n\t\t// Because we are reusing existing innerImage blocks any reordering\n\t\t// done in the media library will be lost so we need to reapply that ordering\n\t\t// once the new image blocks are merged in with existing.\n\t\tconst newOrderMap = processedImages.reduce(\n\t\t\t( result, image, index ) => (\n\t\t\t\t( result[ image.id ] = index ), result\n\t\t\t),\n\t\t\t{}\n\t\t);\n\n\t\tconst existingImageBlocks = ! newFileUploads\n\t\t\t? innerBlockImages.filter( ( block ) =>\n\t\t\t\t\tprocessedImages.find(\n\t\t\t\t\t\t( img ) => img.id === block.attributes.id\n\t\t\t\t\t)\n\t\t\t  )\n\t\t\t: innerBlockImages;\n\n\t\tconst newImageList = processedImages.filter(\n\t\t\t( img ) =>\n\t\t\t\t! existingImageBlocks.find(\n\t\t\t\t\t( existingImg ) => img.id === existingImg.attributes.id\n\t\t\t\t)\n\t\t);\n\n\t\tconst newBlocks = newImageList.map( ( image ) => {\n\t\t\treturn createBlock( 'core/image', {\n\t\t\t\tid: image.id,\n\t\t\t\turl: image.url,\n\t\t\t\tcaption: image.caption,\n\t\t\t\talt: image.alt,\n\t\t\t} );\n\t\t} );\n\n\t\treplaceInnerBlocks(\n\t\t\tclientId,\n\t\t\texistingImageBlocks\n\t\t\t\t.concat( newBlocks )\n\t\t\t\t.sort(\n\t\t\t\t\t( a, b ) =>\n\t\t\t\t\t\tnewOrderMap[ a.attributes.id ] -\n\t\t\t\t\t\tnewOrderMap[ b.attributes.id ]\n\t\t\t\t)\n\t\t);\n\n\t\t// Select the first block to scroll into view when new blocks are added.\n\t\tif ( newBlocks?.length > 0 ) {\n\t\t\tselectBlock( newBlocks[ 0 ].clientId );\n\t\t}\n\t}\n\n\tfunction onUploadError( message ) {\n\t\tcreateErrorNotice( message, { type: 'snackbar' } );\n\t}\n\n\tfunction setLinkTo( value ) {\n\t\tsetAttributes( { linkTo: value } );\n\t\tconst changedAttributes = {};\n\t\tconst blocks = [];\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\n\t\t\tblocks.push( block.clientId );\n\t\t\tconst image = block.attributes.id\n\t\t\t\t? imageData.find( ( { id } ) => id === block.attributes.id )\n\t\t\t\t: null;\n\t\t\tchangedAttributes[ block.clientId ] = getHrefAndDestination(\n\t\t\t\timage,\n\t\t\t\tvalue\n\t\t\t);\n\t\t} );\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\n\t\tconst linkToText = [ ...linkOptions ].find(\n\t\t\t( linkType ) => linkType.value === value\n\t\t);\n\n\t\tcreateSuccessNotice(\n\t\t\tsprintf(\n\t\t\t\t/* translators: %s: image size settings */\n\t\t\t\t__( 'All gallery image links updated to: %s' ),\n\t\t\t\tlinkToText.label\n\t\t\t),\n\t\t\t{\n\t\t\t\tid: 'gallery-attributes-linkTo',\n\t\t\t\ttype: 'snackbar',\n\t\t\t}\n\t\t);\n\t}\n\n\tfunction setColumnsNumber( value ) {\n\t\tsetAttributes( { columns: value } );\n\t}\n\n\tfunction toggleImageCrop() {\n\t\tsetAttributes( { imageCrop: ! imageCrop } );\n\t}\n\n\tfunction getImageCropHelp( checked ) {\n\t\treturn checked\n\t\t\t? __( 'Thumbnails are cropped to align.' )\n\t\t\t: __( 'Thumbnails are not cropped.' );\n\t}\n\n\tfunction toggleOpenInNewTab( openInNewTab ) {\n\t\tconst newLinkTarget = openInNewTab ? '_blank' : undefined;\n\t\tsetAttributes( { linkTarget: newLinkTarget } );\n\t\tconst changedAttributes = {};\n\t\tconst blocks = [];\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\n\t\t\tblocks.push( block.clientId );\n\t\t\tchangedAttributes[ block.clientId ] = getUpdatedLinkTargetSettings(\n\t\t\t\tnewLinkTarget,\n\t\t\t\tblock.attributes\n\t\t\t);\n\t\t} );\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\n\t\tconst noticeText = openInNewTab\n\t\t\t? __( 'All gallery images updated to open in new tab' )\n\t\t\t: __( 'All gallery images updated to not open in new tab' );\n\t\tcreateSuccessNotice( noticeText, {\n\t\t\tid: 'gallery-attributes-openInNewTab',\n\t\t\ttype: 'snackbar',\n\t\t} );\n\t}\n\n\tfunction updateImagesSize( newSizeSlug ) {\n\t\tsetAttributes( { sizeSlug: newSizeSlug } );\n\t\tconst changedAttributes = {};\n\t\tconst blocks = [];\n\t\tgetBlock( clientId ).innerBlocks.forEach( ( block ) => {\n\t\t\tblocks.push( block.clientId );\n\t\t\tconst image = block.attributes.id\n\t\t\t\t? imageData.find( ( { id } ) => id === block.attributes.id )\n\t\t\t\t: null;\n\t\t\tchangedAttributes[ block.clientId ] = getImageSizeAttributes(\n\t\t\t\timage,\n\t\t\t\tnewSizeSlug\n\t\t\t);\n\t\t} );\n\t\tupdateBlockAttributes( blocks, changedAttributes, true );\n\t\tconst imageSize = imageSizeOptions.find(\n\t\t\t( size ) => size.value === newSizeSlug\n\t\t);\n\n\t\tcreateSuccessNotice(\n\t\t\tsprintf(\n\t\t\t\t/* translators: %s: image size settings */\n\t\t\t\t__( 'All gallery image sizes updated to: %s' ),\n\t\t\t\timageSize.label\n\t\t\t),\n\t\t\t{\n\t\t\t\tid: 'gallery-attributes-sizeSlug',\n\t\t\t\ttype: 'snackbar',\n\t\t\t}\n\t\t);\n\t}\n\n\tuseEffect( () => {\n\t\t// linkTo attribute must be saved so blocks don't break when changing image_default_link_type in options.php.\n\t\tif ( ! linkTo ) {\n\t\t\t__unstableMarkNextChangeAsNotPersistent();\n\t\t\tsetAttributes( {\n\t\t\t\tlinkTo:\n\t\t\t\t\twindow?.wp?.media?.view?.settings?.defaultProps?.link ||\n\t\t\t\t\tLINK_DESTINATION_NONE,\n\t\t\t} );\n\t\t}\n\t}, [ linkTo ] );\n\n\tconst hasImages = !! images.length;\n\tconst hasImageIds = hasImages && images.some( ( image ) => !! image.id );\n\tconst imagesUploading = images.some( ( img ) =>\n\t\t! Platform.isNative\n\t\t\t? ! img.id && img.url?.indexOf( 'blob:' ) === 0\n\t\t\t: img.url?.indexOf( 'file:' ) === 0\n\t);\n\n\t// MediaPlaceholder props are different between web and native hence, we provide a platform-specific set.\n\tconst mediaPlaceholderProps = Platform.select( {\n\t\tweb: {\n\t\t\taddToGallery: false,\n\t\t\tdisableMediaButtons: imagesUploading,\n\t\t\tvalue: {},\n\t\t},\n\t\tnative: {\n\t\t\taddToGallery: hasImageIds,\n\t\t\tisAppender: hasImages,\n\t\t\tdisableMediaButtons:\n\t\t\t\t( hasImages && ! isSelected ) || imagesUploading,\n\t\t\tvalue: hasImageIds ? images : {},\n\t\t\tautoOpenMediaUpload:\n\t\t\t\t! hasImages && isSelected && wasBlockJustInserted,\n\t\t\tonFocus,\n\t\t},\n\t} );\n\tconst mediaPlaceholder = (\n\t\t<MediaPlaceholder\n\t\t\thandleUpload={ false }\n\t\t\ticon={ sharedIcon }\n\t\t\tlabels={ {\n\t\t\t\ttitle: __( 'Gallery' ),\n\t\t\t\tinstructions: PLACEHOLDER_TEXT,\n\t\t\t} }\n\t\t\tonSelect={ updateImages }\n\t\t\taccept=\"image/*\"\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\tmultiple\n\t\t\tonError={ onUploadError }\n\t\t\t{ ...mediaPlaceholderProps }\n\t\t/>\n\t);\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( className, 'has-nested-images' ),\n\t} );\n\n\tconst nativeInnerBlockProps = Platform.isNative && {\n\t\tmarginHorizontal: 0,\n\t\tmarginVertical: 0,\n\t};\n\n\tconst innerBlocksProps = useInnerBlocksProps( blockProps, {\n\t\tallowedBlocks,\n\t\torientation: 'horizontal',\n\t\trenderAppender: false,\n\t\t...nativeInnerBlockProps,\n\t} );\n\n\tif ( ! hasImages ) {\n\t\treturn (\n\t\t\t<View { ...innerBlocksProps }>\n\t\t\t\t{ innerBlocksProps.children }\n\t\t\t\t{ mediaPlaceholder }\n\t\t\t</View>\n\t\t);\n\t}\n\n\tconst hasLinkTo = linkTo && linkTo !== 'none';\n\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t\t\t{ images.length > 1 && (\n\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\tlabel={ __( 'Columns' ) }\n\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\tcolumns\n\t\t\t\t\t\t\t\t\t? columns\n\t\t\t\t\t\t\t\t\t: defaultColumnsNumber( images.length )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonChange={ setColumnsNumber }\n\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\tmax={ Math.min( MAX_COLUMNS, images.length ) }\n\t\t\t\t\t\t\t{ ...MOBILE_CONTROL_PROPS_RANGE_CONTROL }\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Crop images' ) }\n\t\t\t\t\t\tchecked={ !! imageCrop }\n\t\t\t\t\t\tonChange={ toggleImageCrop }\n\t\t\t\t\t\thelp={ getImageCropHelp }\n\t\t\t\t\t/>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Link to' ) }\n\t\t\t\t\t\tvalue={ linkTo }\n\t\t\t\t\t\tonChange={ setLinkTo }\n\t\t\t\t\t\toptions={ linkOptions }\n\t\t\t\t\t\thideCancelButton={ true }\n\t\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\t/>\n\t\t\t\t\t{ hasLinkTo && (\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\n\t\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\n\t\t\t\t\t\t\tonChange={ toggleOpenInNewTab }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ imageSizeOptions?.length > 0 && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\tlabel={ __( 'Resolution' ) }\n\t\t\t\t\t\t\thelp={ __(\n\t\t\t\t\t\t\t\t'Select the size of the source images.'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\tvalue={ sizeSlug }\n\t\t\t\t\t\t\toptions={ imageSizeOptions }\n\t\t\t\t\t\t\tonChange={ updateImagesSize }\n\t\t\t\t\t\t\thideCancelButton={ true }\n\t\t\t\t\t\t\tsize=\"__unstable-large\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ Platform.isWeb && ! imageSizeOptions && hasImageIds && (\n\t\t\t\t\t\t<BaseControl className={ 'gallery-image-sizes' }>\n\t\t\t\t\t\t\t<BaseControl.VisualLabel>\n\t\t\t\t\t\t\t\t{ __( 'Resolution' ) }\n\t\t\t\t\t\t\t</BaseControl.VisualLabel>\n\t\t\t\t\t\t\t<View className={ 'gallery-image-sizes__loading' }>\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t\t{ __( 'Loading options…' ) }\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t</BaseControl>\n\t\t\t\t\t) }\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t{ Platform.isWeb && (\n\t\t\t\t<>\n\t\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t\t{ ! isContentLocked && (\n\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tsetShowCaption( ! showCaption );\n\t\t\t\t\t\t\t\t\tif ( showCaption && caption ) {\n\t\t\t\t\t\t\t\t\t\tsetAttributes( { caption: undefined } );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\ticon={ captionIcon }\n\t\t\t\t\t\t\t\tisPressed={ showCaption }\n\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\tshowCaption\n\t\t\t\t\t\t\t\t\t\t? __( 'Remove caption' )\n\t\t\t\t\t\t\t\t\t\t: __( 'Add caption' )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</BlockControls>\n\t\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t\t<MediaReplaceFlow\n\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t\thandleUpload={ false }\n\t\t\t\t\t\t\tonSelect={ updateImages }\n\t\t\t\t\t\t\tname={ __( 'Add' ) }\n\t\t\t\t\t\t\tmultiple={ true }\n\t\t\t\t\t\t\tmediaIds={ images\n\t\t\t\t\t\t\t\t.filter( ( image ) => image.id )\n\t\t\t\t\t\t\t\t.map( ( image ) => image.id ) }\n\t\t\t\t\t\t\taddToGallery={ hasImageIds }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t\t<GapStyles\n\t\t\t\t\t\tblockGap={ attributes.style?.spacing?.blockGap }\n\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t) }\n\t\t\t<Gallery\n\t\t\t\t{ ...props }\n\t\t\t\tshowCaption={ showCaption }\n\t\t\t\tref={ Platform.isWeb ? captionRef : undefined }\n\t\t\t\timages={ images }\n\t\t\t\tmediaPlaceholder={\n\t\t\t\t\t! hasImages || Platform.isNative\n\t\t\t\t\t\t? mediaPlaceholder\n\t\t\t\t\t\t: undefined\n\t\t\t\t}\n\t\t\t\tblockProps={ innerBlocksProps }\n\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t/>\n\t\t</>\n\t);\n}\nexport default compose( [ withViewportMatch( { isNarrow: '< small' } ) ] )(\n\tGalleryEdit\n);\n"],"mappings":"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"}