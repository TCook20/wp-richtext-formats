{"version":3,"names":["_element","require","_classnames","_interopRequireDefault","_blob","_components","_data","_blockEditor","_i18n","_icons","_notices","_image","_constants","pickRelevantMediaFiles","image","size","imageProps","Object","fromEntries","entries","filter","key","includes","url","sizes","media_details","source_url","exports","isTemporaryImage","id","isBlobURL","isExternalImage","hasDefaultSize","defaultSize","_image$sizes$defaultS","_image$media_details$","ImageEdit","attributes","setAttributes","isSelected","className","insertBlocksAfter","onReplace","context","clientId","alt","caption","align","width","height","sizeSlug","temporaryURL","setTemporaryURL","useState","altRef","useRef","useEffect","current","captionRef","ref","imageDefaultSize","mediaUpload","useSelect","select","getSettings","blockEditorStore","settings","blockEditingMode","useBlockEditingMode","createErrorNotice","useDispatch","noticesStore","onUploadError","message","type","src","undefined","onSelectImage","media","title","mediaAttributes","omittedCaption","restMediaAttributes","additionalAttributes","linkDestination","window","wp","view","defaultProps","link","LINK_DESTINATION_NONE","LINK_DESTINATION_MEDIA","LINK_DESTINATION_ATTACHMENT","LINK_DESTINATION_CUSTOM","href","onSelectURL","newURL","updateAlignment","nextAlign","extraUpdatedAttributes","isTemp","file","getBlobByURL","filesList","onFileChange","img","allowedTypes","ALLOWED_MEDIA_TYPES","onError","revokeBlobURL","isExternal","mediaPreview","createElement","__","borderProps","useBorderProps","classes","classnames","style","keys","length","blockProps","useBlockProps","placeholder","content","Placeholder","withIllustration","icon","label","instructions","default","containerRef","BlockControls","group","BlockAlignmentControl","value","onChange","MediaPlaceholder","BlockIcon","onSelect","accept","disableMediaButtons","_default"],"sources":["@wordpress/block-library/src/image/edit.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { getBlobByURL, isBlobURL, revokeBlobURL } from '@wordpress/blob';\nimport { Placeholder } from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport {\n\tBlockAlignmentControl,\n\tBlockControls,\n\tBlockIcon,\n\tMediaPlaceholder,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n\t__experimentalUseBorderProps as useBorderProps,\n\tuseBlockEditingMode,\n} from '@wordpress/block-editor';\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { image as icon } from '@wordpress/icons';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport Image from './image';\n\n/**\n * Module constants\n */\nimport {\n\tLINK_DESTINATION_ATTACHMENT,\n\tLINK_DESTINATION_CUSTOM,\n\tLINK_DESTINATION_MEDIA,\n\tLINK_DESTINATION_NONE,\n\tALLOWED_MEDIA_TYPES,\n} from './constants';\n\nexport const pickRelevantMediaFiles = ( image, size ) => {\n\tconst imageProps = Object.fromEntries(\n\t\tObject.entries( image ?? {} ).filter( ( [ key ] ) =>\n\t\t\t[ 'alt', 'id', 'link', 'caption' ].includes( key )\n\t\t)\n\t);\n\n\timageProps.url =\n\t\timage?.sizes?.[ size ]?.url ||\n\t\timage?.media_details?.sizes?.[ size ]?.source_url ||\n\t\timage.url;\n\treturn imageProps;\n};\n\n/**\n * Is the URL a temporary blob URL? A blob URL is one that is used temporarily\n * while the image is being uploaded and will not have an id yet allocated.\n *\n * @param {number=} id  The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the URL a Blob URL\n */\nconst isTemporaryImage = ( id, url ) => ! id && isBlobURL( url );\n\n/**\n * Is the url for the image hosted externally. An externally hosted image has no\n * id and is not a blob url.\n *\n * @param {number=} id  The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the url an externally hosted url?\n */\nexport const isExternalImage = ( id, url ) => url && ! id && ! isBlobURL( url );\n\n/**\n * Checks if WP generated default image size. Size generation is skipped\n * when the image is smaller than the said size.\n *\n * @param {Object} image\n * @param {string} defaultSize\n *\n * @return {boolean} Whether or not it has default image size.\n */\nfunction hasDefaultSize( image, defaultSize ) {\n\treturn (\n\t\t'url' in ( image?.sizes?.[ defaultSize ] ?? {} ) ||\n\t\t'source_url' in ( image?.media_details?.sizes?.[ defaultSize ] ?? {} )\n\t);\n}\n\nexport function ImageEdit( {\n\tattributes,\n\tsetAttributes,\n\tisSelected,\n\tclassName,\n\tinsertBlocksAfter,\n\tonReplace,\n\tcontext,\n\tclientId,\n} ) {\n\tconst {\n\t\turl = '',\n\t\talt,\n\t\tcaption,\n\t\talign,\n\t\tid,\n\t\twidth,\n\t\theight,\n\t\tsizeSlug,\n\t} = attributes;\n\tconst [ temporaryURL, setTemporaryURL ] = useState();\n\n\tconst altRef = useRef();\n\tuseEffect( () => {\n\t\taltRef.current = alt;\n\t}, [ alt ] );\n\n\tconst captionRef = useRef();\n\tuseEffect( () => {\n\t\tcaptionRef.current = caption;\n\t}, [ caption ] );\n\n\tconst ref = useRef();\n\tconst { imageDefaultSize, mediaUpload } = useSelect( ( select ) => {\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst settings = getSettings();\n\t\treturn {\n\t\t\timageDefaultSize: settings.imageDefaultSize,\n\t\t\tmediaUpload: settings.mediaUpload,\n\t\t};\n\t}, [] );\n\tconst blockEditingMode = useBlockEditingMode();\n\n\tconst { createErrorNotice } = useDispatch( noticesStore );\n\tfunction onUploadError( message ) {\n\t\tcreateErrorNotice( message, { type: 'snackbar' } );\n\t\tsetAttributes( {\n\t\t\tsrc: undefined,\n\t\t\tid: undefined,\n\t\t\turl: undefined,\n\t\t} );\n\t\tsetTemporaryURL( undefined );\n\t}\n\n\tfunction onSelectImage( media ) {\n\t\tif ( ! media || ! media.url ) {\n\t\t\tsetAttributes( {\n\t\t\t\turl: undefined,\n\t\t\t\talt: undefined,\n\t\t\t\tid: undefined,\n\t\t\t\ttitle: undefined,\n\t\t\t\tcaption: undefined,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( isBlobURL( media.url ) ) {\n\t\t\tsetTemporaryURL( media.url );\n\t\t\treturn;\n\t\t}\n\n\t\tsetTemporaryURL();\n\n\t\tlet mediaAttributes = pickRelevantMediaFiles( media, imageDefaultSize );\n\n\t\t// If a caption text was meanwhile written by the user,\n\t\t// make sure the text is not overwritten by empty captions.\n\t\tif ( captionRef.current && ! mediaAttributes.caption ) {\n\t\t\tconst { caption: omittedCaption, ...restMediaAttributes } =\n\t\t\t\tmediaAttributes;\n\t\t\tmediaAttributes = restMediaAttributes;\n\t\t}\n\n\t\tlet additionalAttributes;\n\t\t// Reset the dimension attributes if changing to a different image.\n\t\tif ( ! media.id || media.id !== id ) {\n\t\t\tadditionalAttributes = {\n\t\t\t\t// Fallback to size \"full\" if there's no default image size.\n\t\t\t\t// It means the image is smaller, and the block will use a full-size URL.\n\t\t\t\tsizeSlug: hasDefaultSize( media, imageDefaultSize )\n\t\t\t\t\t? imageDefaultSize\n\t\t\t\t\t: 'full',\n\t\t\t};\n\t\t} else {\n\t\t\t// Keep the same url when selecting the same file, so \"Resolution\"\n\t\t\t// option is not changed.\n\t\t\tadditionalAttributes = { url };\n\t\t}\n\n\t\t// Check if default link setting should be used.\n\t\tlet linkDestination = attributes.linkDestination;\n\t\tif ( ! linkDestination ) {\n\t\t\t// Use the WordPress option to determine the proper default.\n\t\t\t// The constants used in Gutenberg do not match WP options so a little more complicated than ideal.\n\t\t\t// TODO: fix this in a follow up PR, requires updating media-text and ui component.\n\t\t\tswitch (\n\t\t\t\twindow?.wp?.media?.view?.settings?.defaultProps?.link ||\n\t\t\t\tLINK_DESTINATION_NONE\n\t\t\t) {\n\t\t\t\tcase 'file':\n\t\t\t\tcase LINK_DESTINATION_MEDIA:\n\t\t\t\t\tlinkDestination = LINK_DESTINATION_MEDIA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'post':\n\t\t\t\tcase LINK_DESTINATION_ATTACHMENT:\n\t\t\t\t\tlinkDestination = LINK_DESTINATION_ATTACHMENT;\n\t\t\t\t\tbreak;\n\t\t\t\tcase LINK_DESTINATION_CUSTOM:\n\t\t\t\t\tlinkDestination = LINK_DESTINATION_CUSTOM;\n\t\t\t\t\tbreak;\n\t\t\t\tcase LINK_DESTINATION_NONE:\n\t\t\t\t\tlinkDestination = LINK_DESTINATION_NONE;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Check if the image is linked to it's media.\n\t\tlet href;\n\t\tswitch ( linkDestination ) {\n\t\t\tcase LINK_DESTINATION_MEDIA:\n\t\t\t\thref = media.url;\n\t\t\t\tbreak;\n\t\t\tcase LINK_DESTINATION_ATTACHMENT:\n\t\t\t\thref = media.link;\n\t\t\t\tbreak;\n\t\t}\n\t\tmediaAttributes.href = href;\n\n\t\tsetAttributes( {\n\t\t\t...mediaAttributes,\n\t\t\t...additionalAttributes,\n\t\t\tlinkDestination,\n\t\t} );\n\t}\n\n\tfunction onSelectURL( newURL ) {\n\t\tif ( newURL !== url ) {\n\t\t\tsetAttributes( {\n\t\t\t\turl: newURL,\n\t\t\t\tid: undefined,\n\t\t\t\tsizeSlug: imageDefaultSize,\n\t\t\t} );\n\t\t}\n\t}\n\n\tfunction updateAlignment( nextAlign ) {\n\t\tconst extraUpdatedAttributes = [ 'wide', 'full' ].includes( nextAlign )\n\t\t\t? { width: undefined, height: undefined }\n\t\t\t: {};\n\t\tsetAttributes( {\n\t\t\t...extraUpdatedAttributes,\n\t\t\talign: nextAlign,\n\t\t} );\n\t}\n\n\tlet isTemp = isTemporaryImage( id, url );\n\n\t// Upload a temporary image on mount.\n\tuseEffect( () => {\n\t\tif ( ! isTemp ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst file = getBlobByURL( url );\n\n\t\tif ( file ) {\n\t\t\tmediaUpload( {\n\t\t\t\tfilesList: [ file ],\n\t\t\t\tonFileChange: ( [ img ] ) => {\n\t\t\t\t\tonSelectImage( img );\n\t\t\t\t},\n\t\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\t\tonError: ( message ) => {\n\t\t\t\t\tisTemp = false;\n\t\t\t\t\tonUploadError( message );\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\t}, [] );\n\n\t// If an image is temporary, revoke the Blob url when it is uploaded (and is\n\t// no longer temporary).\n\tuseEffect( () => {\n\t\tif ( isTemp ) {\n\t\t\tsetTemporaryURL( url );\n\t\t\treturn;\n\t\t}\n\t\trevokeBlobURL( temporaryURL );\n\t}, [ isTemp, url ] );\n\n\tconst isExternal = isExternalImage( id, url );\n\tconst src = isExternal ? url : undefined;\n\tconst mediaPreview = !! url && (\n\t\t<img\n\t\t\talt={ __( 'Edit image' ) }\n\t\t\ttitle={ __( 'Edit image' ) }\n\t\t\tclassName={ 'edit-image-preview' }\n\t\t\tsrc={ url }\n\t\t/>\n\t);\n\n\tconst borderProps = useBorderProps( attributes );\n\n\tconst classes = classnames( className, {\n\t\t'is-transient': temporaryURL,\n\t\t'is-resized': !! width || !! height,\n\t\t[ `size-${ sizeSlug }` ]: sizeSlug,\n\t\t'has-custom-border':\n\t\t\t!! borderProps.className ||\n\t\t\t( borderProps.style &&\n\t\t\t\tObject.keys( borderProps.style ).length > 0 ),\n\t} );\n\n\tconst blockProps = useBlockProps( {\n\t\tref,\n\t\tclassName: classes,\n\t} );\n\n\t// Much of this description is duplicated from MediaPlaceholder.\n\tconst placeholder = ( content ) => {\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\tclassName={ classnames( 'block-editor-media-placeholder', {\n\t\t\t\t\t[ borderProps.className ]:\n\t\t\t\t\t\t!! borderProps.className && ! isSelected,\n\t\t\t\t} ) }\n\t\t\t\twithIllustration={ true }\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ __( 'Image' ) }\n\t\t\t\tinstructions={ __(\n\t\t\t\t\t'Upload an image file, pick one from your media library, or add one with a URL.'\n\t\t\t\t) }\n\t\t\t\tstyle={ isSelected ? undefined : borderProps.style }\n\t\t\t>\n\t\t\t\t{ content }\n\t\t\t</Placeholder>\n\t\t);\n\t};\n\n\treturn (\n\t\t<figure { ...blockProps }>\n\t\t\t{ ( temporaryURL || url ) && (\n\t\t\t\t<Image\n\t\t\t\t\ttemporaryURL={ temporaryURL }\n\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\tonSelectImage={ onSelectImage }\n\t\t\t\t\tonSelectURL={ onSelectURL }\n\t\t\t\t\tonUploadError={ onUploadError }\n\t\t\t\t\tcontainerRef={ ref }\n\t\t\t\t\tcontext={ context }\n\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\tblockEditingMode={ blockEditingMode }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ ! url && blockEditingMode === 'default' && (\n\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t<BlockAlignmentControl\n\t\t\t\t\t\tvalue={ align }\n\t\t\t\t\t\tonChange={ updateAlignment }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t<MediaPlaceholder\n\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\tonSelect={ onSelectImage }\n\t\t\t\tonSelectURL={ onSelectURL }\n\t\t\t\tonError={ onUploadError }\n\t\t\t\tplaceholder={ placeholder }\n\t\t\t\taccept=\"image/*\"\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tvalue={ { id, src } }\n\t\t\t\tmediaPreview={ mediaPreview }\n\t\t\t\tdisableMediaButtons={ temporaryURL || url }\n\t\t\t/>\n\t\t</figure>\n\t);\n}\n\nexport default ImageEdit;\n"],"mappings":"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"}