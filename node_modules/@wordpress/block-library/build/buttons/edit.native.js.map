{"version":3,"names":["_element","require","_reactNative","_blockEditor","_blocks","_compose","_data","_components","_button","_editor","_interopRequireDefault","ALLOWED_BLOCKS","buttonBlockName","layoutProp","type","alignments","POPOVER_PROPS","placement","ButtonsEdit","attributes","layout","align","clientId","isSelected","setAttributes","blockWidth","name","resizeObserver","sizes","useResizeObserver","maxWidth","setMaxWidth","useState","marginLeft","spacing","styles","layoutBlockSupport","getBlockSupport","defaultBlockLayout","default","usedLayout","justifyContent","isInnerButtonSelected","shouldDelete","useSelect","select","getBlockCount","getBlockParents","getSelectedBlockClientId","blockEditorStore","selectedBlockClientId","selectedBlockParents","preferredStyle","preferredStyleVariations","getSettings","__experimentalPreferredStyleVariations","value","getBlockOrder","insertBlock","removeBlock","selectBlock","useDispatch","useEffect","width","isFullWidth","alignmentHelpers","isFullWidthBlock","onAddNextButton","useCallback","debounce","selectedId","order","selectedButtonIndex","findIndex","i","index","length","insertedBlock","createBlock","renderFooterAppender","useRef","createElement","View","style","appenderContainer","InnerBlocks","ButtonBlockAppender","isFloating","onAddBlock","justifyControls","remove","shouldRenderFooterAppender","Fragment","BlockControls","group","JustifyContentControl","allowedControls","onChange","popoverProps","allowedBlocks","template","className","current","orientation","horizontalAlignment","onDeleteBlock","undefined","parentWidth","marginHorizontal","marginVertical","templateInsertUpdatesSelection"],"sources":["@wordpress/block-library/src/buttons/edit.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tBlockControls,\n\tInnerBlocks,\n\tJustifyContentControl,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { createBlock, getBlockSupport } from '@wordpress/blocks';\nimport { debounce, useResizeObserver } from '@wordpress/compose';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { useState, useEffect, useRef, useCallback } from '@wordpress/element';\nimport { alignmentHelpers } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport { name as buttonBlockName } from '../button/';\nimport styles from './editor.scss';\n\nconst ALLOWED_BLOCKS = [ buttonBlockName ];\n\nconst layoutProp = { type: 'default', alignments: [] };\n\nconst POPOVER_PROPS = {\n\tplacement: 'bottom-start',\n};\n\nexport default function ButtonsEdit( {\n\tattributes: { layout, align },\n\tclientId,\n\tisSelected,\n\tsetAttributes,\n\tblockWidth,\n\tname,\n} ) {\n\tconst [ resizeObserver, sizes ] = useResizeObserver();\n\tconst [ maxWidth, setMaxWidth ] = useState( 0 );\n\tconst { marginLeft: spacing } = styles.spacing;\n\n\t// Extract attributes from block layout\n\tconst layoutBlockSupport = getBlockSupport( name, 'layout' );\n\tconst defaultBlockLayout = layoutBlockSupport?.default;\n\tconst usedLayout = layout || defaultBlockLayout || {};\n\tconst { justifyContent } = usedLayout;\n\n\tconst { isInnerButtonSelected, shouldDelete } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockCount, getBlockParents, getSelectedBlockClientId } =\n\t\t\t\tselect( blockEditorStore );\n\t\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\t\t\tconst selectedBlockParents = getBlockParents(\n\t\t\t\tselectedBlockClientId,\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tisInnerButtonSelected: selectedBlockParents[ 0 ] === clientId,\n\t\t\t\t// The purpose of `shouldDelete` check is giving the ability to\n\t\t\t\t// pass to mobile toolbar function called `onDelete` which removes\n\t\t\t\t// the whole `Buttons` container along with the last inner button\n\t\t\t\t// when there is exactly one button.\n\t\t\t\tshouldDelete: getBlockCount( clientId ) === 1,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst preferredStyle = useSelect( ( select ) => {\n\t\tconst preferredStyleVariations =\n\t\t\tselect( blockEditorStore ).getSettings()\n\t\t\t\t.__experimentalPreferredStyleVariations;\n\t\treturn preferredStyleVariations?.value?.[ buttonBlockName ];\n\t}, [] );\n\n\tconst { getBlockOrder } = useSelect( blockEditorStore );\n\tconst { insertBlock, removeBlock, selectBlock } =\n\t\tuseDispatch( blockEditorStore );\n\n\tuseEffect( () => {\n\t\tconst { width } = sizes || {};\n\t\tconst { isFullWidth } = alignmentHelpers;\n\n\t\tif ( width ) {\n\t\t\tconst isFullWidthBlock = isFullWidth( align );\n\t\t\tsetMaxWidth( isFullWidthBlock ? blockWidth : width );\n\t\t}\n\t}, [ sizes, align ] );\n\n\tconst onAddNextButton = useCallback(\n\t\tdebounce( ( selectedId ) => {\n\t\t\tconst order = getBlockOrder( clientId );\n\t\t\tconst selectedButtonIndex = order.findIndex(\n\t\t\t\t( i ) => i === selectedId\n\t\t\t);\n\n\t\t\tconst index =\n\t\t\t\tselectedButtonIndex === -1\n\t\t\t\t\t? order.length + 1\n\t\t\t\t\t: selectedButtonIndex;\n\n\t\t\tconst insertedBlock = createBlock( 'core/button' );\n\n\t\t\tinsertBlock( insertedBlock, index, clientId, false );\n\t\t\tselectBlock( insertedBlock.clientId );\n\t\t}, 200 ),\n\t\t[]\n\t);\n\n\tconst renderFooterAppender = useRef( () => (\n\t\t<View style={ styles.appenderContainer }>\n\t\t\t<InnerBlocks.ButtonBlockAppender\n\t\t\t\tisFloating={ true }\n\t\t\t\tonAddBlock={ onAddNextButton }\n\t\t\t/>\n\t\t</View>\n\t) );\n\n\tconst justifyControls = [ 'left', 'center', 'right' ];\n\n\tconst remove = useCallback( () => removeBlock( clientId ), [ clientId ] );\n\tconst shouldRenderFooterAppender = isSelected || isInnerButtonSelected;\n\treturn (\n\t\t<>\n\t\t\t{ isSelected && (\n\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t<JustifyContentControl\n\t\t\t\t\t\tallowedControls={ justifyControls }\n\t\t\t\t\t\tvalue={ justifyContent }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t...usedLayout,\n\t\t\t\t\t\t\t\t\tjustifyContent: value,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopoverProps={ POPOVER_PROPS }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ resizeObserver }\n\t\t\t<InnerBlocks\n\t\t\t\tallowedBlocks={ ALLOWED_BLOCKS }\n\t\t\t\ttemplate={ [\n\t\t\t\t\t[\n\t\t\t\t\t\tbuttonBlockName,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tclassName:\n\t\t\t\t\t\t\t\tpreferredStyle &&\n\t\t\t\t\t\t\t\t`is-style-${ preferredStyle }`,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t] }\n\t\t\t\trenderFooterAppender={\n\t\t\t\t\tshouldRenderFooterAppender && renderFooterAppender.current\n\t\t\t\t}\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\thorizontalAlignment={ justifyContent }\n\t\t\t\tonDeleteBlock={ shouldDelete ? remove : undefined }\n\t\t\t\tonAddBlock={ onAddNextButton }\n\t\t\t\tparentWidth={ maxWidth } // This value controls the width of that the buttons are able to expand to.\n\t\t\t\tmarginHorizontal={ spacing }\n\t\t\t\tmarginVertical={ spacing }\n\t\t\t\tlayout={ layoutProp }\n\t\t\t\ttemplateInsertUpdatesSelection\n\t\t\t\tblockWidth={ blockWidth }\n\t\t\t/>\n\t\t</>\n\t);\n}\n"],"mappings":"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"}