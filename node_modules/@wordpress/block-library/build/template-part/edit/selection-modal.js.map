{"version":3,"names":["_element","require","_i18n","_notices","_data","_blocks","_compose","_blockEditor","_components","_hooks","_createTemplatePartId","_searchPatterns","TemplatePartSelectionModal","setAttributes","onClose","templatePartId","area","clientId","searchValue","setSearchValue","useState","templateParts","useAlternativeTemplateParts","filteredTemplateParts","useMemo","partsAsPatterns","map","templatePart","name","createTemplatePartId","theme","slug","title","rendered","blocks","parse","content","raw","searchPatterns","shownTemplateParts","useAsyncList","blockPatterns","useAlternativeBlockPatterns","filteredBlockPatterns","shownBlockPatterns","createSuccessNotice","useDispatch","noticesStore","onTemplatePartSelect","undefined","sprintf","__","type","createFromBlocks","useCreateTemplatePartFromBlocks","hasTemplateParts","length","hasBlockPatterns","createElement","className","SearchControl","__nextHasNoMarginBottom","onChange","value","label","placeholder","__experimentalBlockPatternsList","shownPatterns","onClickPattern","pattern","__experimentalHStack","alignment"],"sources":["@wordpress/block-library/src/template-part/edit/selection-modal.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useMemo, useState } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { useDispatch } from '@wordpress/data';\nimport { parse } from '@wordpress/blocks';\nimport { useAsyncList } from '@wordpress/compose';\nimport { __experimentalBlockPatternsList as BlockPatternsList } from '@wordpress/block-editor';\nimport {\n\tSearchControl,\n\t__experimentalHStack as HStack,\n} from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport {\n\tuseAlternativeBlockPatterns,\n\tuseAlternativeTemplateParts,\n\tuseCreateTemplatePartFromBlocks,\n} from './utils/hooks';\nimport { createTemplatePartId } from './utils/create-template-part-id';\nimport { searchPatterns } from '../../utils/search-patterns';\n\nexport default function TemplatePartSelectionModal( {\n\tsetAttributes,\n\tonClose,\n\ttemplatePartId = null,\n\tarea,\n\tclientId,\n} ) {\n\tconst [ searchValue, setSearchValue ] = useState( '' );\n\n\tconst { templateParts } = useAlternativeTemplateParts(\n\t\tarea,\n\t\ttemplatePartId\n\t);\n\t// We can map template parts to block patters to reuse the BlockPatternsList UI\n\tconst filteredTemplateParts = useMemo( () => {\n\t\tconst partsAsPatterns = templateParts.map( ( templatePart ) => ( {\n\t\t\tname: createTemplatePartId( templatePart.theme, templatePart.slug ),\n\t\t\ttitle: templatePart.title.rendered,\n\t\t\tblocks: parse( templatePart.content.raw ),\n\t\t\ttemplatePart,\n\t\t} ) );\n\n\t\treturn searchPatterns( partsAsPatterns, searchValue );\n\t}, [ templateParts, searchValue ] );\n\tconst shownTemplateParts = useAsyncList( filteredTemplateParts );\n\tconst blockPatterns = useAlternativeBlockPatterns( area, clientId );\n\tconst filteredBlockPatterns = useMemo( () => {\n\t\treturn searchPatterns( blockPatterns, searchValue );\n\t}, [ blockPatterns, searchValue ] );\n\tconst shownBlockPatterns = useAsyncList( filteredBlockPatterns );\n\n\tconst { createSuccessNotice } = useDispatch( noticesStore );\n\n\tconst onTemplatePartSelect = ( templatePart ) => {\n\t\tsetAttributes( {\n\t\t\tslug: templatePart.slug,\n\t\t\ttheme: templatePart.theme,\n\t\t\tarea: undefined,\n\t\t} );\n\t\tcreateSuccessNotice(\n\t\t\tsprintf(\n\t\t\t\t/* translators: %s: template part title. */\n\t\t\t\t__( 'Template Part \"%s\" inserted.' ),\n\t\t\t\ttemplatePart.title?.rendered || templatePart.slug\n\t\t\t),\n\t\t\t{\n\t\t\t\ttype: 'snackbar',\n\t\t\t}\n\t\t);\n\t\tonClose();\n\t};\n\n\tconst createFromBlocks = useCreateTemplatePartFromBlocks(\n\t\tarea,\n\t\tsetAttributes\n\t);\n\n\tconst hasTemplateParts = !! filteredTemplateParts.length;\n\tconst hasBlockPatterns = !! filteredBlockPatterns.length;\n\n\treturn (\n\t\t<div className=\"block-library-template-part__selection-content\">\n\t\t\t<div className=\"block-library-template-part__selection-search\">\n\t\t\t\t<SearchControl\n\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\tonChange={ setSearchValue }\n\t\t\t\t\tvalue={ searchValue }\n\t\t\t\t\tlabel={ __( 'Search for replacements' ) }\n\t\t\t\t\tplaceholder={ __( 'Search' ) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{ hasTemplateParts && (\n\t\t\t\t<div>\n\t\t\t\t\t<h2>{ __( 'Existing template parts' ) }</h2>\n\t\t\t\t\t<BlockPatternsList\n\t\t\t\t\t\tblockPatterns={ filteredTemplateParts }\n\t\t\t\t\t\tshownPatterns={ shownTemplateParts }\n\t\t\t\t\t\tonClickPattern={ ( pattern ) => {\n\t\t\t\t\t\t\tonTemplatePartSelect( pattern.templatePart );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t) }\n\n\t\t\t{ hasBlockPatterns && (\n\t\t\t\t<div>\n\t\t\t\t\t<h2>{ __( 'Patterns' ) }</h2>\n\t\t\t\t\t<BlockPatternsList\n\t\t\t\t\t\tblockPatterns={ filteredBlockPatterns }\n\t\t\t\t\t\tshownPatterns={ shownBlockPatterns }\n\t\t\t\t\t\tonClickPattern={ ( pattern, blocks ) => {\n\t\t\t\t\t\t\tcreateFromBlocks( blocks, pattern.title );\n\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t) }\n\n\t\t\t{ ! hasTemplateParts && ! hasBlockPatterns && (\n\t\t\t\t<HStack alignment=\"center\">\n\t\t\t\t\t<p>{ __( 'No results found.' ) }</p>\n\t\t\t\t</HStack>\n\t\t\t) }\n\t\t</div>\n\t);\n}\n"],"mappings":"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"}