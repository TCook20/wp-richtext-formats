{"version":3,"names":["_element","require","_classnames","_interopRequireDefault","_blob","_components","_blockEditor","_i18n","_compose","_data","_icons","_blocks","_notices","_util","_editCommonSettings","_tracksEditor","_tracks","placeholder","content","createElement","Placeholder","className","withIllustration","icon","label","__","instructions","ALLOWED_MEDIA_TYPES","VIDEO_POSTER_ALLOWED_MEDIA_TYPES","VideoEdit","isSelected","attributes","setAttributes","insertBlocksAfter","onReplace","instanceId","useInstanceId","videoPlayer","useRef","posterImageButton","id","caption","controls","poster","src","tracks","prevCaption","usePrevious","showCaption","setShowCaption","useState","isTemporaryVideo","isBlobURL","mediaUpload","useSelect","select","blockEditorStore","getSettings","useEffect","file","getBlobByURL","filesList","onFileChange","media","onSelectVideo","onError","onUploadError","allowedTypes","current","load","captionRef","useCallback","node","focus","url","undefined","image","onSelectURL","newSrc","embedBlock","createUpgradedEmbedBlock","createErrorNotice","useDispatch","noticesStore","message","type","classes","classnames","blockProps","useBlockProps","MediaPlaceholder","BlockIcon","onSelect","accept","value","onSelectPoster","onRemovePoster","videoPosterDescription","Fragment","BlockControls","group","ToolbarButton","onClick","captionIcon","isPressed","default","onChange","newTracks","MediaReplaceFlow","mediaId","mediaURL","InspectorControls","PanelBody","title","MediaUploadCheck","BaseControl","VisualLabel","MediaUpload","render","open","Button","variant","ref","hidden","sprintf","Disabled","isDisabled","Spinner","RichText","isEmpty","identifier","tagName","__experimentalGetElementClassName","inlineToolbar","__unstableOnSplitAtEnd","createBlock","getDefaultBlockName","_default","exports"],"sources":["@wordpress/block-library/src/video/edit.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { getBlobByURL, isBlobURL } from '@wordpress/blob';\nimport {\n\tBaseControl,\n\tButton,\n\tDisabled,\n\tPanelBody,\n\tSpinner,\n\tPlaceholder,\n\tToolbarButton,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tBlockIcon,\n\tInspectorControls,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tMediaUploadCheck,\n\tMediaReplaceFlow,\n\tRichText,\n\tuseBlockProps,\n\tstore as blockEditorStore,\n\t__experimentalGetElementClassName,\n} from '@wordpress/block-editor';\nimport { useRef, useEffect, useState, useCallback } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useInstanceId, usePrevious } from '@wordpress/compose';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { video as icon, caption as captionIcon } from '@wordpress/icons';\nimport { createBlock, getDefaultBlockName } from '@wordpress/blocks';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { createUpgradedEmbedBlock } from '../embed/util';\nimport VideoCommonSettings from './edit-common-settings';\nimport TracksEditor from './tracks-editor';\nimport Tracks from './tracks';\n\n// Much of this description is duplicated from MediaPlaceholder.\nconst placeholder = ( content ) => {\n\treturn (\n\t\t<Placeholder\n\t\t\tclassName=\"block-editor-media-placeholder\"\n\t\t\twithIllustration={ true }\n\t\t\ticon={ icon }\n\t\t\tlabel={ __( 'Video' ) }\n\t\t\tinstructions={ __(\n\t\t\t\t'Upload a video file, pick one from your media library, or add one with a URL.'\n\t\t\t) }\n\t\t>\n\t\t\t{ content }\n\t\t</Placeholder>\n\t);\n};\n\nconst ALLOWED_MEDIA_TYPES = [ 'video' ];\nconst VIDEO_POSTER_ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nfunction VideoEdit( {\n\tisSelected,\n\tattributes,\n\tclassName,\n\tsetAttributes,\n\tinsertBlocksAfter,\n\tonReplace,\n} ) {\n\tconst instanceId = useInstanceId( VideoEdit );\n\tconst videoPlayer = useRef();\n\tconst posterImageButton = useRef();\n\tconst { id, caption, controls, poster, src, tracks } = attributes;\n\tconst prevCaption = usePrevious( caption );\n\tconst [ showCaption, setShowCaption ] = useState( !! caption );\n\tconst isTemporaryVideo = ! id && isBlobURL( src );\n\tconst mediaUpload = useSelect(\n\t\t( select ) => select( blockEditorStore ).getSettings().mediaUpload,\n\t\t[]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( ! id && isBlobURL( src ) ) {\n\t\t\tconst file = getBlobByURL( src );\n\t\t\tif ( file ) {\n\t\t\t\tmediaUpload( {\n\t\t\t\t\tfilesList: [ file ],\n\t\t\t\t\tonFileChange: ( [ media ] ) => onSelectVideo( media ),\n\t\t\t\t\tonError: onUploadError,\n\t\t\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}, [] );\n\n\tuseEffect( () => {\n\t\t// Placeholder may be rendered.\n\t\tif ( videoPlayer.current ) {\n\t\t\tvideoPlayer.current.load();\n\t\t}\n\t}, [ poster ] );\n\n\t// We need to show the caption when changes come from\n\t// history navigation(undo/redo).\n\tuseEffect( () => {\n\t\tif ( caption && ! prevCaption ) {\n\t\t\tsetShowCaption( true );\n\t\t}\n\t}, [ caption, prevCaption ] );\n\n\t// Focus the caption when we click to add one.\n\tconst captionRef = useCallback(\n\t\t( node ) => {\n\t\t\tif ( node && ! caption ) {\n\t\t\t\tnode.focus();\n\t\t\t}\n\t\t},\n\t\t[ caption ]\n\t);\n\n\tuseEffect( () => {\n\t\tif ( ! isSelected && ! caption ) {\n\t\t\tsetShowCaption( false );\n\t\t}\n\t}, [ isSelected, caption ] );\n\n\tfunction onSelectVideo( media ) {\n\t\tif ( ! media || ! media.url ) {\n\t\t\t// In this case there was an error\n\t\t\t// previous attributes should be removed\n\t\t\t// because they may be temporary blob urls.\n\t\t\tsetAttributes( {\n\t\t\t\tsrc: undefined,\n\t\t\t\tid: undefined,\n\t\t\t\tposter: undefined,\n\t\t\t\tcaption: undefined,\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\t// Sets the block's attribute and updates the edit component from the\n\t\t// selected media.\n\t\tsetAttributes( {\n\t\t\tsrc: media.url,\n\t\t\tid: media.id,\n\t\t\tposter:\n\t\t\t\tmedia.image?.src !== media.icon ? media.image?.src : undefined,\n\t\t\tcaption: media.caption,\n\t\t} );\n\t}\n\n\tfunction onSelectURL( newSrc ) {\n\t\tif ( newSrc !== src ) {\n\t\t\t// Check if there's an embed block that handles this URL.\n\t\t\tconst embedBlock = createUpgradedEmbedBlock( {\n\t\t\t\tattributes: { url: newSrc },\n\t\t\t} );\n\t\t\tif ( undefined !== embedBlock && onReplace ) {\n\t\t\t\tonReplace( embedBlock );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetAttributes( { src: newSrc, id: undefined, poster: undefined } );\n\t\t}\n\t}\n\n\tconst { createErrorNotice } = useDispatch( noticesStore );\n\tfunction onUploadError( message ) {\n\t\tcreateErrorNotice( message, { type: 'snackbar' } );\n\t}\n\n\tconst classes = classnames( className, {\n\t\t'is-transient': isTemporaryVideo,\n\t} );\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classes,\n\t} );\n\n\tif ( ! src ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<MediaPlaceholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tonSelect={ onSelectVideo }\n\t\t\t\t\tonSelectURL={ onSelectURL }\n\t\t\t\t\taccept=\"video/*\"\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\tvalue={ attributes }\n\t\t\t\t\tonError={ onUploadError }\n\t\t\t\t\tplaceholder={ placeholder }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tfunction onSelectPoster( image ) {\n\t\tsetAttributes( { poster: image.url } );\n\t}\n\n\tfunction onRemovePoster() {\n\t\tsetAttributes( { poster: undefined } );\n\n\t\t// Move focus back to the Media Upload button.\n\t\tposterImageButton.current.focus();\n\t}\n\n\tconst videoPosterDescription = `video-block__poster-image-description-${ instanceId }`;\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls group=\"block\">\n\t\t\t\t<ToolbarButton\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tsetShowCaption( ! showCaption );\n\t\t\t\t\t\tif ( showCaption && caption ) {\n\t\t\t\t\t\t\tsetAttributes( { caption: undefined } );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t\ticon={ captionIcon }\n\t\t\t\t\tisPressed={ showCaption }\n\t\t\t\t\tlabel={\n\t\t\t\t\t\tshowCaption\n\t\t\t\t\t\t\t? __( 'Remove caption' )\n\t\t\t\t\t\t\t: __( 'Add caption' )\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<BlockControls>\n\t\t\t\t<TracksEditor\n\t\t\t\t\ttracks={ tracks }\n\t\t\t\t\tonChange={ ( newTracks ) => {\n\t\t\t\t\t\tsetAttributes( { tracks: newTracks } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<BlockControls group=\"other\">\n\t\t\t\t<MediaReplaceFlow\n\t\t\t\t\tmediaId={ id }\n\t\t\t\t\tmediaURL={ src }\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\taccept=\"video/*\"\n\t\t\t\t\tonSelect={ onSelectVideo }\n\t\t\t\t\tonSelectURL={ onSelectURL }\n\t\t\t\t\tonError={ onUploadError }\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t\t\t<VideoCommonSettings\n\t\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t/>\n\t\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t\t<BaseControl className=\"editor-video-poster-control\">\n\t\t\t\t\t\t\t<BaseControl.VisualLabel>\n\t\t\t\t\t\t\t\t{ __( 'Poster image' ) }\n\t\t\t\t\t\t\t</BaseControl.VisualLabel>\n\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\ttitle={ __( 'Select poster image' ) }\n\t\t\t\t\t\t\t\tonSelect={ onSelectPoster }\n\t\t\t\t\t\t\t\tallowedTypes={\n\t\t\t\t\t\t\t\t\tVIDEO_POSTER_ALLOWED_MEDIA_TYPES\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t\t\t\tref={ posterImageButton }\n\t\t\t\t\t\t\t\t\t\taria-describedby={\n\t\t\t\t\t\t\t\t\t\t\tvideoPosterDescription\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ ! poster\n\t\t\t\t\t\t\t\t\t\t\t? __( 'Select' )\n\t\t\t\t\t\t\t\t\t\t\t: __( 'Replace' ) }\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<p id={ videoPosterDescription } hidden>\n\t\t\t\t\t\t\t\t{ poster\n\t\t\t\t\t\t\t\t\t? sprintf(\n\t\t\t\t\t\t\t\t\t\t\t/* translators: %s: poster image URL. */\n\t\t\t\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t\t\t\t'The current poster image url is %s'\n\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\tposter\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: __(\n\t\t\t\t\t\t\t\t\t\t\t'There is no poster image currently selected'\n\t\t\t\t\t\t\t\t\t  ) }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{ !! poster && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={ onRemovePoster }\n\t\t\t\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Remove' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</BaseControl>\n\t\t\t\t\t</MediaUploadCheck>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<figure { ...blockProps }>\n\t\t\t\t{ /*\n\t\t\t\t\tDisable the video tag if the block is not selected\n\t\t\t\t\tso the user clicking on it won't play the\n\t\t\t\t\tvideo when the controls are enabled.\n\t\t\t\t*/ }\n\t\t\t\t<Disabled isDisabled={ ! isSelected }>\n\t\t\t\t\t<video\n\t\t\t\t\t\tcontrols={ controls }\n\t\t\t\t\t\tposter={ poster }\n\t\t\t\t\t\tsrc={ src }\n\t\t\t\t\t\tref={ videoPlayer }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Tracks tracks={ tracks } />\n\t\t\t\t\t</video>\n\t\t\t\t</Disabled>\n\t\t\t\t{ isTemporaryVideo && <Spinner /> }\n\t\t\t\t{ showCaption &&\n\t\t\t\t\t( ! RichText.isEmpty( caption ) || isSelected ) && (\n\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\tidentifier=\"caption\"\n\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\tclassName={ __experimentalGetElementClassName(\n\t\t\t\t\t\t\t\t'caption'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\taria-label={ __( 'Video caption text' ) }\n\t\t\t\t\t\t\tref={ captionRef }\n\t\t\t\t\t\t\tplaceholder={ __( 'Add caption' ) }\n\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\t\tsetAttributes( { caption: value } )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinlineToolbar\n\t\t\t\t\t\t\t__unstableOnSplitAtEnd={ () =>\n\t\t\t\t\t\t\t\tinsertBlocksAfter(\n\t\t\t\t\t\t\t\t\tcreateBlock( getDefaultBlockName() )\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t</figure>\n\t\t</>\n\t);\n}\n\nexport default VideoEdit;\n"],"mappings":";;;;;;;AA+BA,IAAAA,QAAA,GAAAC,OAAA;AA5BA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AAKA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,WAAA,GAAAJ,OAAA;AASA,IAAAK,YAAA,GAAAL,OAAA;AAcA,IAAAM,KAAA,GAAAN,OAAA;AACA,IAAAO,QAAA,GAAAP,OAAA;AACA,IAAAQ,KAAA,GAAAR,OAAA;AACA,IAAAS,MAAA,GAAAT,OAAA;AACA,IAAAU,OAAA,GAAAV,OAAA;AACA,IAAAW,QAAA,GAAAX,OAAA;AAKA,IAAAY,KAAA,GAAAZ,OAAA;AACA,IAAAa,mBAAA,GAAAX,sBAAA,CAAAF,OAAA;AACA,IAAAc,aAAA,GAAAZ,sBAAA,CAAAF,OAAA;AACA,IAAAe,OAAA,GAAAb,sBAAA,CAAAF,OAAA;AA7CA;AACA;AACA;;AAGA;AACA;AACA;;AAgCA;AACA;AACA;;AAMA;AACA,MAAMgB,WAAW,GAAKC,OAAO,IAAM;EAClC,OACC,IAAAlB,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAAe,WAAW;IACXC,SAAS,EAAC,gCAAgC;IAC1CC,gBAAgB,EAAG,IAAM;IACzBC,IAAI,EAAGA,YAAM;IACbC,KAAK,EAAG,IAAAC,QAAE,EAAE,OAAQ,CAAG;IACvBC,YAAY,EAAG,IAAAD,QAAE,EAChB,+EACD;EAAG,GAEDP,OACU,CAAC;AAEhB,CAAC;AAED,MAAMS,mBAAmB,GAAG,CAAE,OAAO,CAAE;AACvC,MAAMC,gCAAgC,GAAG,CAAE,OAAO,CAAE;AAEpD,SAASC,SAASA,CAAE;EACnBC,UAAU;EACVC,UAAU;EACVV,SAAS;EACTW,aAAa;EACbC,iBAAiB;EACjBC;AACD,CAAC,EAAG;EACH,MAAMC,UAAU,GAAG,IAAAC,sBAAa,EAAEP,SAAU,CAAC;EAC7C,MAAMQ,WAAW,GAAG,IAAAC,eAAM,EAAC,CAAC;EAC5B,MAAMC,iBAAiB,GAAG,IAAAD,eAAM,EAAC,CAAC;EAClC,MAAM;IAAEE,EAAE;IAAEC,OAAO;IAAEC,QAAQ;IAAEC,MAAM;IAAEC,GAAG;IAAEC;EAAO,CAAC,GAAGd,UAAU;EACjE,MAAMe,WAAW,GAAG,IAAAC,oBAAW,EAAEN,OAAQ,CAAC;EAC1C,MAAM,CAAEO,WAAW,EAAEC,cAAc,CAAE,GAAG,IAAAC,iBAAQ,EAAE,CAAC,CAAET,OAAQ,CAAC;EAC9D,MAAMU,gBAAgB,GAAG,CAAEX,EAAE,IAAI,IAAAY,eAAS,EAAER,GAAI,CAAC;EACjD,MAAMS,WAAW,GAAG,IAAAC,eAAS,EAC1BC,MAAM,IAAMA,MAAM,CAAEC,kBAAiB,CAAC,CAACC,WAAW,CAAC,CAAC,CAACJ,WAAW,EAClE,EACD,CAAC;EAED,IAAAK,kBAAS,EAAE,MAAM;IAChB,IAAK,CAAElB,EAAE,IAAI,IAAAY,eAAS,EAAER,GAAI,CAAC,EAAG;MAC/B,MAAMe,IAAI,GAAG,IAAAC,kBAAY,EAAEhB,GAAI,CAAC;MAChC,IAAKe,IAAI,EAAG;QACXN,WAAW,CAAE;UACZQ,SAAS,EAAE,CAAEF,IAAI,CAAE;UACnBG,YAAY,EAAEA,CAAE,CAAEC,KAAK,CAAE,KAAMC,aAAa,CAAED,KAAM,CAAC;UACrDE,OAAO,EAAEC,aAAa;UACtBC,YAAY,EAAExC;QACf,CAAE,CAAC;MACJ;IACD;EACD,CAAC,EAAE,EAAG,CAAC;EAEP,IAAA+B,kBAAS,EAAE,MAAM;IAChB;IACA,IAAKrB,WAAW,CAAC+B,OAAO,EAAG;MAC1B/B,WAAW,CAAC+B,OAAO,CAACC,IAAI,CAAC,CAAC;IAC3B;EACD,CAAC,EAAE,CAAE1B,MAAM,CAAG,CAAC;;EAEf;EACA;EACA,IAAAe,kBAAS,EAAE,MAAM;IAChB,IAAKjB,OAAO,IAAI,CAAEK,WAAW,EAAG;MAC/BG,cAAc,CAAE,IAAK,CAAC;IACvB;EACD,CAAC,EAAE,CAAER,OAAO,EAAEK,WAAW,CAAG,CAAC;;EAE7B;EACA,MAAMwB,UAAU,GAAG,IAAAC,oBAAW,EAC3BC,IAAI,IAAM;IACX,IAAKA,IAAI,IAAI,CAAE/B,OAAO,EAAG;MACxB+B,IAAI,CAACC,KAAK,CAAC,CAAC;IACb;EACD,CAAC,EACD,CAAEhC,OAAO,CACV,CAAC;EAED,IAAAiB,kBAAS,EAAE,MAAM;IAChB,IAAK,CAAE5B,UAAU,IAAI,CAAEW,OAAO,EAAG;MAChCQ,cAAc,CAAE,KAAM,CAAC;IACxB;EACD,CAAC,EAAE,CAAEnB,UAAU,EAAEW,OAAO,CAAG,CAAC;EAE5B,SAASuB,aAAaA,CAAED,KAAK,EAAG;IAC/B,IAAK,CAAEA,KAAK,IAAI,CAAEA,KAAK,CAACW,GAAG,EAAG;MAC7B;MACA;MACA;MACA1C,aAAa,CAAE;QACdY,GAAG,EAAE+B,SAAS;QACdnC,EAAE,EAAEmC,SAAS;QACbhC,MAAM,EAAEgC,SAAS;QACjBlC,OAAO,EAAEkC;MACV,CAAE,CAAC;MACH;IACD;;IAEA;IACA;IACA3C,aAAa,CAAE;MACdY,GAAG,EAAEmB,KAAK,CAACW,GAAG;MACdlC,EAAE,EAAEuB,KAAK,CAACvB,EAAE;MACZG,MAAM,EACLoB,KAAK,CAACa,KAAK,EAAEhC,GAAG,KAAKmB,KAAK,CAACxC,IAAI,GAAGwC,KAAK,CAACa,KAAK,EAAEhC,GAAG,GAAG+B,SAAS;MAC/DlC,OAAO,EAAEsB,KAAK,CAACtB;IAChB,CAAE,CAAC;EACJ;EAEA,SAASoC,WAAWA,CAAEC,MAAM,EAAG;IAC9B,IAAKA,MAAM,KAAKlC,GAAG,EAAG;MACrB;MACA,MAAMmC,UAAU,GAAG,IAAAC,8BAAwB,EAAE;QAC5CjD,UAAU,EAAE;UAAE2C,GAAG,EAAEI;QAAO;MAC3B,CAAE,CAAC;MACH,IAAKH,SAAS,KAAKI,UAAU,IAAI7C,SAAS,EAAG;QAC5CA,SAAS,CAAE6C,UAAW,CAAC;QACvB;MACD;MACA/C,aAAa,CAAE;QAAEY,GAAG,EAAEkC,MAAM;QAAEtC,EAAE,EAAEmC,SAAS;QAAEhC,MAAM,EAAEgC;MAAU,CAAE,CAAC;IACnE;EACD;EAEA,MAAM;IAAEM;EAAkB,CAAC,GAAG,IAAAC,iBAAW,EAAEC,cAAa,CAAC;EACzD,SAASjB,aAAaA,CAAEkB,OAAO,EAAG;IACjCH,iBAAiB,CAAEG,OAAO,EAAE;MAAEC,IAAI,EAAE;IAAW,CAAE,CAAC;EACnD;EAEA,MAAMC,OAAO,GAAG,IAAAC,mBAAU,EAAElE,SAAS,EAAE;IACtC,cAAc,EAAE8B;EACjB,CAAE,CAAC;EAEH,MAAMqC,UAAU,GAAG,IAAAC,0BAAa,EAAE;IACjCpE,SAAS,EAAEiE;EACZ,CAAE,CAAC;EAEH,IAAK,CAAE1C,GAAG,EAAG;IACZ,OACC,IAAA5C,QAAA,CAAAmB,aAAA;MAAA,GAAUqE;IAAU,GACnB,IAAAxF,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAAoF,gBAAgB;MAChBnE,IAAI,EAAG,IAAAvB,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAAqF,SAAS;QAACpE,IAAI,EAAGA;MAAM,CAAE,CAAG;MACpCqE,QAAQ,EAAG5B,aAAe;MAC1Ba,WAAW,EAAGA,WAAa;MAC3BgB,MAAM,EAAC,SAAS;MAChB1B,YAAY,EAAGxC,mBAAqB;MACpCmE,KAAK,EAAG/D,UAAY;MACpBkC,OAAO,EAAGC,aAAe;MACzBjD,WAAW,EAAGA;IAAa,CAC3B,CACG,CAAC;EAER;EAEA,SAAS8E,cAAcA,CAAEnB,KAAK,EAAG;IAChC5C,aAAa,CAAE;MAAEW,MAAM,EAAEiC,KAAK,CAACF;IAAI,CAAE,CAAC;EACvC;EAEA,SAASsB,cAAcA,CAAA,EAAG;IACzBhE,aAAa,CAAE;MAAEW,MAAM,EAAEgC;IAAU,CAAE,CAAC;;IAEtC;IACApC,iBAAiB,CAAC6B,OAAO,CAACK,KAAK,CAAC,CAAC;EAClC;EAEA,MAAMwB,sBAAsB,GAAI,yCAAyC9D,UAAY,EAAC;EAEtF,OACC,IAAAnC,QAAA,CAAAmB,aAAA,EAAAnB,QAAA,CAAAkG,QAAA,QACC,IAAAlG,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA6F,aAAa;IAACC,KAAK,EAAC;EAAO,GAC3B,IAAApG,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAAgG,aAAa;IACbC,OAAO,EAAGA,CAAA,KAAM;MACfrD,cAAc,CAAE,CAAED,WAAY,CAAC;MAC/B,IAAKA,WAAW,IAAIP,OAAO,EAAG;QAC7BT,aAAa,CAAE;UAAES,OAAO,EAAEkC;QAAU,CAAE,CAAC;MACxC;IACD,CAAG;IACHpD,IAAI,EAAGgF,cAAa;IACpBC,SAAS,EAAGxD,WAAa;IACzBxB,KAAK,EACJwB,WAAW,GACR,IAAAvB,QAAE,EAAE,gBAAiB,CAAC,GACtB,IAAAA,QAAE,EAAE,aAAc;EACrB,CACD,CACa,CAAC,EAChB,IAAAzB,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA6F,aAAa,QACb,IAAAnG,QAAA,CAAAmB,aAAA,EAACJ,aAAA,CAAA0F,OAAY;IACZ5D,MAAM,EAAGA,MAAQ;IACjB6D,QAAQ,EAAKC,SAAS,IAAM;MAC3B3E,aAAa,CAAE;QAAEa,MAAM,EAAE8D;MAAU,CAAE,CAAC;IACvC;EAAG,CACH,CACa,CAAC,EAChB,IAAA3G,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA6F,aAAa;IAACC,KAAK,EAAC;EAAO,GAC3B,IAAApG,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAAsG,gBAAgB;IAChBC,OAAO,EAAGrE,EAAI;IACdsE,QAAQ,EAAGlE,GAAK;IAChBuB,YAAY,EAAGxC,mBAAqB;IACpCkE,MAAM,EAAC,SAAS;IAChBD,QAAQ,EAAG5B,aAAe;IAC1Ba,WAAW,EAAGA,WAAa;IAC3BZ,OAAO,EAAGC;EAAe,CACzB,CACa,CAAC,EAChB,IAAAlE,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAAyG,iBAAiB,QACjB,IAAA/G,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAA2G,SAAS;IAACC,KAAK,EAAG,IAAAxF,QAAE,EAAE,UAAW;EAAG,GACpC,IAAAzB,QAAA,CAAAmB,aAAA,EAACL,mBAAA,CAAA2F,OAAmB;IACnBzE,aAAa,EAAGA,aAAe;IAC/BD,UAAU,EAAGA;EAAY,CACzB,CAAC,EACF,IAAA/B,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA4G,gBAAgB,QAChB,IAAAlH,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAA8G,WAAW;IAAC9F,SAAS,EAAC;EAA6B,GACnD,IAAArB,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAA8G,WAAW,CAACC,WAAW,QACrB,IAAA3F,QAAE,EAAE,cAAe,CACG,CAAC,EAC1B,IAAAzB,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA+G,WAAW;IACXJ,KAAK,EAAG,IAAAxF,QAAE,EAAE,qBAAsB,CAAG;IACrCmE,QAAQ,EAAGG,cAAgB;IAC3B5B,YAAY,EACXvC,gCACA;IACD0F,MAAM,EAAGA,CAAE;MAAEC;IAAK,CAAC,KAClB,IAAAvH,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAAmH,MAAM;MACNC,OAAO,EAAC,SAAS;MACjBnB,OAAO,EAAGiB,IAAM;MAChBG,GAAG,EAAGnF,iBAAmB;MACzB,oBACC0D;IACA,GAEC,CAAEtD,MAAM,GACP,IAAAlB,QAAE,EAAE,QAAS,CAAC,GACd,IAAAA,QAAE,EAAE,SAAU,CACV;EACN,CACH,CAAC,EACF,IAAAzB,QAAA,CAAAmB,aAAA;IAAGqB,EAAE,EAAGyD,sBAAwB;IAAC0B,MAAM;EAAA,GACpChF,MAAM,GACL,IAAAiF,aAAO,GACP;EACA,IAAAnG,QAAE,EACD,oCACD,CAAC,EACDkB,MACA,CAAC,GACD,IAAAlB,QAAE,EACF,6CACA,CACD,CAAC,EACF,CAAC,CAAEkB,MAAM,IACV,IAAA3C,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAAmH,MAAM;IACNlB,OAAO,EAAGN,cAAgB;IAC1ByB,OAAO,EAAC;EAAU,GAEhB,IAAAhG,QAAE,EAAE,QAAS,CACR,CAEG,CACI,CACR,CACO,CAAC,EACpB,IAAAzB,QAAA,CAAAmB,aAAA;IAAA,GAAaqE;EAAU,GAMtB,IAAAxF,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAAwH,QAAQ;IAACC,UAAU,EAAG,CAAEhG;EAAY,GACpC,IAAA9B,QAAA,CAAAmB,aAAA;IACCuB,QAAQ,EAAGA,QAAU;IACrBC,MAAM,EAAGA,MAAQ;IACjBC,GAAG,EAAGA,GAAK;IACX8E,GAAG,EAAGrF;EAAa,GAEnB,IAAArC,QAAA,CAAAmB,aAAA,EAACH,OAAA,CAAAyF,OAAM;IAAC5D,MAAM,EAAGA;EAAQ,CAAE,CACrB,CACE,CAAC,EACTM,gBAAgB,IAAI,IAAAnD,QAAA,CAAAmB,aAAA,EAACd,WAAA,CAAA0H,OAAO,MAAE,CAAC,EAC/B/E,WAAW,KACV,CAAEgF,qBAAQ,CAACC,OAAO,CAAExF,OAAQ,CAAC,IAAIX,UAAU,CAAE,IAC9C,IAAA9B,QAAA,CAAAmB,aAAA,EAACb,YAAA,CAAA0H,QAAQ;IACRE,UAAU,EAAC,SAAS;IACpBC,OAAO,EAAC,YAAY;IACpB9G,SAAS,EAAG,IAAA+G,8CAAiC,EAC5C,SACD,CAAG;IACH,cAAa,IAAA3G,QAAE,EAAE,oBAAqB,CAAG;IACzCiG,GAAG,EAAGpD,UAAY;IAClBrD,WAAW,EAAG,IAAAQ,QAAE,EAAE,aAAc,CAAG;IACnCqE,KAAK,EAAGrD,OAAS;IACjBiE,QAAQ,EAAKZ,KAAK,IACjB9D,aAAa,CAAE;MAAES,OAAO,EAAEqD;IAAM,CAAE,CAClC;IACDuC,aAAa;IACbC,sBAAsB,EAAGA,CAAA,KACxBrG,iBAAiB,CAChB,IAAAsG,mBAAW,EAAE,IAAAC,2BAAmB,EAAC,CAAE,CACpC;EACA,CACD,CAEI,CACP,CAAC;AAEL;AAAC,IAAAC,QAAA,GAEc5G,SAAS;AAAA6G,OAAA,CAAAjC,OAAA,GAAAgC,QAAA"}