{"version":3,"names":["_classnames","_interopRequireDefault","require","_blocks","_blockEditor","getDeprecatedLayoutColumn","originalContent","doc","document","implementation","createHTMLDocument","columnMatch","body","innerHTML","classListItem","firstChild","classList","match","Number","migrateCustomColors","attributes","customTextColor","customBackgroundColor","style","color","text","background","restAttributes","isStackedOnMobile","_default","verticalAlignment","type","backgroundColor","textColor","migrate","save","backgroundClass","getColorClassName","textClass","className","classnames","undefined","_element","createElement","InnerBlocks","Content","columns","default","isEligible","innerBlocks","isFastPassEligible","some","innerBlock","test","reduce","accumulator","columnIndex","push","migratedInnerBlocks","map","columnBlocks","createBlock","ignoredColumns","wrapperClasses","exports"],"sources":["@wordpress/block-library/src/columns/deprecated.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\nimport { InnerBlocks, getColorClassName } from '@wordpress/block-editor';\n\n/**\n * Given an HTML string for a deprecated columns inner block, returns the\n * column index to which the migrated inner block should be assigned. Returns\n * undefined if the inner block was not assigned to a column.\n *\n * @param {string} originalContent Deprecated Columns inner block HTML.\n *\n * @return {number | undefined} Column to which inner block is to be assigned.\n */\nfunction getDeprecatedLayoutColumn( originalContent ) {\n\tlet { doc } = getDeprecatedLayoutColumn;\n\tif ( ! doc ) {\n\t\tdoc = document.implementation.createHTMLDocument( '' );\n\t\tgetDeprecatedLayoutColumn.doc = doc;\n\t}\n\n\tlet columnMatch;\n\n\tdoc.body.innerHTML = originalContent;\n\tfor ( const classListItem of doc.body.firstChild.classList ) {\n\t\tif (\n\t\t\t( columnMatch = classListItem.match( /^layout-column-(\\d+)$/ ) )\n\t\t) {\n\t\t\treturn Number( columnMatch[ 1 ] ) - 1;\n\t\t}\n\t}\n}\n\nconst migrateCustomColors = ( attributes ) => {\n\tif ( ! attributes.customTextColor && ! attributes.customBackgroundColor ) {\n\t\treturn attributes;\n\t}\n\tconst style = { color: {} };\n\tif ( attributes.customTextColor ) {\n\t\tstyle.color.text = attributes.customTextColor;\n\t}\n\tif ( attributes.customBackgroundColor ) {\n\t\tstyle.color.background = attributes.customBackgroundColor;\n\t}\n\n\tconst { customTextColor, customBackgroundColor, ...restAttributes } =\n\t\tattributes;\n\n\treturn {\n\t\t...restAttributes,\n\t\tstyle,\n\t\tisStackedOnMobile: true,\n\t};\n};\n\nexport default [\n\t{\n\t\tattributes: {\n\t\t\tverticalAlignment: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t\tbackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t\tcustomBackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t\tcustomTextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t\ttextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t},\n\t\tmigrate: migrateCustomColors,\n\t\tsave( { attributes } ) {\n\t\t\tconst {\n\t\t\t\tverticalAlignment,\n\t\t\t\tbackgroundColor,\n\t\t\t\tcustomBackgroundColor,\n\t\t\t\ttextColor,\n\t\t\t\tcustomTextColor,\n\t\t\t} = attributes;\n\n\t\t\tconst backgroundClass = getColorClassName(\n\t\t\t\t'background-color',\n\t\t\t\tbackgroundColor\n\t\t\t);\n\n\t\t\tconst textClass = getColorClassName( 'color', textColor );\n\n\t\t\tconst className = classnames( {\n\t\t\t\t'has-background': backgroundColor || customBackgroundColor,\n\t\t\t\t'has-text-color': textColor || customTextColor,\n\t\t\t\t[ backgroundClass ]: backgroundClass,\n\t\t\t\t[ textClass ]: textClass,\n\t\t\t\t[ `are-vertically-aligned-${ verticalAlignment }` ]:\n\t\t\t\t\tverticalAlignment,\n\t\t\t} );\n\n\t\t\tconst style = {\n\t\t\t\tbackgroundColor: backgroundClass\n\t\t\t\t\t? undefined\n\t\t\t\t\t: customBackgroundColor,\n\t\t\t\tcolor: textClass ? undefined : customTextColor,\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName={ className ? className : undefined }\n\t\t\t\t\tstyle={ style }\n\t\t\t\t>\n\t\t\t\t\t<InnerBlocks.Content />\n\t\t\t\t</div>\n\t\t\t);\n\t\t},\n\t},\n\t{\n\t\tattributes: {\n\t\t\tcolumns: {\n\t\t\t\ttype: 'number',\n\t\t\t\tdefault: 2,\n\t\t\t},\n\t\t},\n\t\tisEligible( attributes, innerBlocks ) {\n\t\t\t// Since isEligible is called on every valid instance of the\n\t\t\t// Columns block and a deprecation is the unlikely case due to\n\t\t\t// its subsequent migration, optimize for the `false` condition\n\t\t\t// by performing a naive, inaccurate pass at inner blocks.\n\t\t\tconst isFastPassEligible = innerBlocks.some( ( innerBlock ) =>\n\t\t\t\t/layout-column-\\d+/.test( innerBlock.originalContent )\n\t\t\t);\n\n\t\t\tif ( ! isFastPassEligible ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Only if the fast pass is considered eligible is the more\n\t\t\t// accurate, durable, slower condition performed.\n\t\t\treturn innerBlocks.some(\n\t\t\t\t( innerBlock ) =>\n\t\t\t\t\tgetDeprecatedLayoutColumn( innerBlock.originalContent ) !==\n\t\t\t\t\tundefined\n\t\t\t);\n\t\t},\n\t\tmigrate( attributes, innerBlocks ) {\n\t\t\tconst columns = innerBlocks.reduce( ( accumulator, innerBlock ) => {\n\t\t\t\tconst { originalContent } = innerBlock;\n\n\t\t\t\tlet columnIndex = getDeprecatedLayoutColumn( originalContent );\n\t\t\t\tif ( columnIndex === undefined ) {\n\t\t\t\t\tcolumnIndex = 0;\n\t\t\t\t}\n\n\t\t\t\tif ( ! accumulator[ columnIndex ] ) {\n\t\t\t\t\taccumulator[ columnIndex ] = [];\n\t\t\t\t}\n\n\t\t\t\taccumulator[ columnIndex ].push( innerBlock );\n\n\t\t\t\treturn accumulator;\n\t\t\t}, [] );\n\n\t\t\tconst migratedInnerBlocks = columns.map( ( columnBlocks ) =>\n\t\t\t\tcreateBlock( 'core/column', {}, columnBlocks )\n\t\t\t);\n\n\t\t\tconst { columns: ignoredColumns, ...restAttributes } = attributes;\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\t...restAttributes,\n\t\t\t\t\tisStackedOnMobile: true,\n\t\t\t\t},\n\t\t\t\tmigratedInnerBlocks,\n\t\t\t];\n\t\t},\n\t\tsave( { attributes } ) {\n\t\t\tconst { columns } = attributes;\n\n\t\t\treturn (\n\t\t\t\t<div className={ `has-${ columns }-columns` }>\n\t\t\t\t\t<InnerBlocks.Content />\n\t\t\t\t</div>\n\t\t\t);\n\t\t},\n\t},\n\t{\n\t\tattributes: {\n\t\t\tcolumns: {\n\t\t\t\ttype: 'number',\n\t\t\t\tdefault: 2,\n\t\t\t},\n\t\t},\n\t\tmigrate( attributes, innerBlocks ) {\n\t\t\tconst { columns, ...restAttributes } = attributes;\n\t\t\tattributes = {\n\t\t\t\t...restAttributes,\n\t\t\t\tisStackedOnMobile: true,\n\t\t\t};\n\n\t\t\treturn [ attributes, innerBlocks ];\n\t\t},\n\t\tsave( { attributes } ) {\n\t\t\tconst { verticalAlignment, columns } = attributes;\n\n\t\t\tconst wrapperClasses = classnames( `has-${ columns }-columns`, {\n\t\t\t\t[ `are-vertically-aligned-${ verticalAlignment }` ]:\n\t\t\t\t\tverticalAlignment,\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<div className={ wrapperClasses }>\n\t\t\t\t\t<InnerBlocks.Content />\n\t\t\t\t</div>\n\t\t\t);\n\t\t},\n\t},\n];\n"],"mappings":"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"}