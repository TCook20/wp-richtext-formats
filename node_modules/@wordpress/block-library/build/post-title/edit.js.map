{"version":3,"names":["_classnames","_interopRequireDefault","require","_blockEditor","_components","_i18n","_blocks","_coreData","_hooks","PostTitleEdit","attributes","level","textAlign","isLink","rel","linkTarget","setAttributes","context","postType","postId","queryId","insertBlocksAfter","TagName","isDescendentOfQueryLoop","Number","isFinite","userCanEdit","useCanEditEntity","rawTitle","setTitle","fullTitle","useEntityProp","link","onSplitAtEnd","createBlock","getDefaultBlockName","blockProps","useBlockProps","className","classnames","blockEditingMode","useBlockEditingMode","titleElement","_element","createElement","__","PlainText","tagName","placeholder","value","onChange","__experimentalVersion","__unstableOnSplitAtEnd","dangerouslySetInnerHTML","__html","rendered","href","target","length","onClick","event","preventDefault","Fragment","BlockControls","group","HeadingLevelDropdown","newLevel","AlignmentControl","nextAlign","InspectorControls","PanelBody","title","ToggleControl","__nextHasNoMarginBottom","label","checked","TextControl","newRel"],"sources":["@wordpress/block-library/src/post-title/edit.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tAlignmentControl,\n\tBlockControls,\n\tInspectorControls,\n\tuseBlockProps,\n\tPlainText,\n\tHeadingLevelDropdown,\n\tuseBlockEditingMode,\n} from '@wordpress/block-editor';\nimport { ToggleControl, TextControl, PanelBody } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { createBlock, getDefaultBlockName } from '@wordpress/blocks';\nimport { useEntityProp } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { useCanEditEntity } from '../utils/hooks';\n\nexport default function PostTitleEdit( {\n\tattributes: { level, textAlign, isLink, rel, linkTarget },\n\tsetAttributes,\n\tcontext: { postType, postId, queryId },\n\tinsertBlocksAfter,\n} ) {\n\tconst TagName = 'h' + level;\n\tconst isDescendentOfQueryLoop = Number.isFinite( queryId );\n\t/**\n\t * Hack: useCanEditEntity may trigger an OPTIONS request to the REST API via the canUser resolver.\n\t * However, when the Post Title is a descendant of a Query Loop block, the title cannot be edited.\n\t * In order to avoid these unnecessary requests, we call the hook without\n\t * the proper data, resulting in returning early without making them.\n\t */\n\tconst userCanEdit = useCanEditEntity(\n\t\t'postType',\n\t\t! isDescendentOfQueryLoop && postType,\n\t\tpostId\n\t);\n\tconst [ rawTitle = '', setTitle, fullTitle ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'title',\n\t\tpostId\n\t);\n\tconst [ link ] = useEntityProp( 'postType', postType, 'link', postId );\n\tconst onSplitAtEnd = () => {\n\t\tinsertBlocksAfter( createBlock( getDefaultBlockName() ) );\n\t};\n\tconst blockProps = useBlockProps( {\n\t\tclassName: classnames( {\n\t\t\t[ `has-text-align-${ textAlign }` ]: textAlign,\n\t\t} ),\n\t} );\n\tconst blockEditingMode = useBlockEditingMode();\n\n\tlet titleElement = <TagName { ...blockProps }>{ __( 'Title' ) }</TagName>;\n\n\tif ( postType && postId ) {\n\t\ttitleElement = userCanEdit ? (\n\t\t\t<PlainText\n\t\t\t\ttagName={ TagName }\n\t\t\t\tplaceholder={ __( 'No Title' ) }\n\t\t\t\tvalue={ rawTitle }\n\t\t\t\tonChange={ setTitle }\n\t\t\t\t__experimentalVersion={ 2 }\n\t\t\t\t__unstableOnSplitAtEnd={ onSplitAtEnd }\n\t\t\t\t{ ...blockProps }\n\t\t\t/>\n\t\t) : (\n\t\t\t<TagName\n\t\t\t\t{ ...blockProps }\n\t\t\t\tdangerouslySetInnerHTML={ { __html: fullTitle?.rendered } }\n\t\t\t/>\n\t\t);\n\t}\n\n\tif ( isLink && postType && postId ) {\n\t\ttitleElement = userCanEdit ? (\n\t\t\t<TagName { ...blockProps }>\n\t\t\t\t<PlainText\n\t\t\t\t\ttagName=\"a\"\n\t\t\t\t\thref={ link }\n\t\t\t\t\ttarget={ linkTarget }\n\t\t\t\t\trel={ rel }\n\t\t\t\t\tplaceholder={ ! rawTitle.length ? __( 'No Title' ) : null }\n\t\t\t\t\tvalue={ rawTitle }\n\t\t\t\t\tonChange={ setTitle }\n\t\t\t\t\t__experimentalVersion={ 2 }\n\t\t\t\t\t__unstableOnSplitAtEnd={ onSplitAtEnd }\n\t\t\t\t/>\n\t\t\t</TagName>\n\t\t) : (\n\t\t\t<TagName { ...blockProps }>\n\t\t\t\t<a\n\t\t\t\t\thref={ link }\n\t\t\t\t\ttarget={ linkTarget }\n\t\t\t\t\trel={ rel }\n\t\t\t\t\tonClick={ ( event ) => event.preventDefault() }\n\t\t\t\t\tdangerouslySetInnerHTML={ {\n\t\t\t\t\t\t__html: fullTitle?.rendered,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</TagName>\n\t\t);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{ blockEditingMode === 'default' && (\n\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t<HeadingLevelDropdown\n\t\t\t\t\t\tvalue={ level }\n\t\t\t\t\t\tonChange={ ( newLevel ) =>\n\t\t\t\t\t\t\tsetAttributes( { level: newLevel } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<AlignmentControl\n\t\t\t\t\t\tvalue={ textAlign }\n\t\t\t\t\t\tonChange={ ( nextAlign ) => {\n\t\t\t\t\t\t\tsetAttributes( { textAlign: nextAlign } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Make title a link' ) }\n\t\t\t\t\t\tonChange={ () => setAttributes( { isLink: ! isLink } ) }\n\t\t\t\t\t\tchecked={ isLink }\n\t\t\t\t\t/>\n\t\t\t\t\t{ isLink && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\n\t\t\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t\tlinkTarget: value ? '_blank' : '_self',\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\tlabel={ __( 'Link rel' ) }\n\t\t\t\t\t\t\t\tvalue={ rel }\n\t\t\t\t\t\t\t\tonChange={ ( newRel ) =>\n\t\t\t\t\t\t\t\t\tsetAttributes( { rel: newRel } )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t{ titleElement }\n\t\t</>\n\t);\n}\n"],"mappings":"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"}