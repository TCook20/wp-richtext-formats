{"version":3,"names":["_i18n","require","_blockEditor","_coreData","_data","_hooks","ReadOnlyContent","userCanEdit","postType","postId","content","useEntityProp","blockProps","useBlockProps","protected","_element","createElement","Warning","__","dangerouslySetInnerHTML","__html","rendered","EditableContent","context","blocks","onInput","onChange","useEntityBlockEditor","id","entityRecord","useSelect","select","coreStore","getEntityRecord","hasInnerBlocks","raw","length","initialInnerBlocks","props","useInnerBlocksProps","className","value","template","undefined","Content","queryId","useCanEditEntity","isDescendentOfQueryLoop","Number","isFinite","isEditable","Placeholder","layoutClassNames","RecursionError","PostContentEdit","attributes","__unstableLayoutClassNames","contextPostId","contextPostType","layout","hasAlreadyRendered","useHasRecursion","__experimentalRecursionProvider","uniqueId"],"sources":["@wordpress/block-library/src/post-content/edit.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tuseBlockProps,\n\tuseInnerBlocksProps,\n\t__experimentalRecursionProvider as RecursionProvider,\n\t__experimentalUseHasRecursion as useHasRecursion,\n\tWarning,\n} from '@wordpress/block-editor';\nimport {\n\tuseEntityProp,\n\tuseEntityBlockEditor,\n\tstore as coreStore,\n} from '@wordpress/core-data';\nimport { useSelect } from '@wordpress/data';\n/**\n * Internal dependencies\n */\nimport { useCanEditEntity } from '../utils/hooks';\n\nfunction ReadOnlyContent( { userCanEdit, postType, postId } ) {\n\tconst [ , , content ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'content',\n\t\tpostId\n\t);\n\tconst blockProps = useBlockProps();\n\treturn content?.protected && ! userCanEdit ? (\n\t\t<div { ...blockProps }>\n\t\t\t<Warning>{ __( 'This content is password protected.' ) }</Warning>\n\t\t</div>\n\t) : (\n\t\t<div\n\t\t\t{ ...blockProps }\n\t\t\tdangerouslySetInnerHTML={ { __html: content?.rendered } }\n\t\t></div>\n\t);\n}\n\nfunction EditableContent( { context = {} } ) {\n\tconst { postType, postId } = context;\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\tpostType,\n\t\t{ id: postId }\n\t);\n\n\tconst entityRecord = useSelect(\n\t\t( select ) => {\n\t\t\treturn select( coreStore ).getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\tpostType,\n\t\t\t\tpostId\n\t\t\t);\n\t\t},\n\t\t[ postType, postId ]\n\t);\n\n\tconst hasInnerBlocks = !! entityRecord?.content?.raw || blocks?.length;\n\n\tconst initialInnerBlocks = [ [ 'core/paragraph' ] ];\n\n\tconst props = useInnerBlocksProps(\n\t\tuseBlockProps( { className: 'entry-content' } ),\n\t\t{\n\t\t\tvalue: blocks,\n\t\t\tonInput,\n\t\t\tonChange,\n\t\t\ttemplate: ! hasInnerBlocks ? initialInnerBlocks : undefined,\n\t\t}\n\t);\n\treturn <div { ...props } />;\n}\n\nfunction Content( props ) {\n\tconst { context: { queryId, postType, postId } = {} } = props;\n\tconst userCanEdit = useCanEditEntity( 'postType', postType, postId );\n\tif ( userCanEdit === undefined ) {\n\t\treturn null;\n\t}\n\n\tconst isDescendentOfQueryLoop = Number.isFinite( queryId );\n\tconst isEditable = userCanEdit && ! isDescendentOfQueryLoop;\n\n\treturn isEditable ? (\n\t\t<EditableContent { ...props } />\n\t) : (\n\t\t<ReadOnlyContent\n\t\t\tuserCanEdit={ userCanEdit }\n\t\t\tpostType={ postType }\n\t\t\tpostId={ postId }\n\t\t/>\n\t);\n}\n\nfunction Placeholder( { layoutClassNames } ) {\n\tconst blockProps = useBlockProps( { className: layoutClassNames } );\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<p>\n\t\t\t\t{ __(\n\t\t\t\t\t'This is the Content block, it will display all the blocks in any single post or page.'\n\t\t\t\t) }\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t{ __(\n\t\t\t\t\t'That might be a simple arrangement like consecutive paragraphs in a blog post, or a more elaborate composition that includes image galleries, videos, tables, columns, and any other block types.'\n\t\t\t\t) }\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t{ __(\n\t\t\t\t\t'If there are any Custom Post Types registered at your site, the Content block can display the contents of those entries as well.'\n\t\t\t\t) }\n\t\t\t</p>\n\t\t</div>\n\t);\n}\n\nfunction RecursionError() {\n\tconst blockProps = useBlockProps();\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<Warning>\n\t\t\t\t{ __( 'Block cannot be rendered inside itself.' ) }\n\t\t\t</Warning>\n\t\t</div>\n\t);\n}\n\nexport default function PostContentEdit( {\n\tcontext,\n\tattributes,\n\t__unstableLayoutClassNames: layoutClassNames,\n} ) {\n\tconst { postId: contextPostId, postType: contextPostType } = context;\n\tconst { layout = {} } = attributes;\n\tconst hasAlreadyRendered = useHasRecursion( contextPostId );\n\n\tif ( contextPostId && contextPostType && hasAlreadyRendered ) {\n\t\treturn <RecursionError />;\n\t}\n\n\treturn (\n\t\t<RecursionProvider uniqueId={ contextPostId }>\n\t\t\t{ contextPostId && contextPostType ? (\n\t\t\t\t<Content context={ context } layout={ layout } />\n\t\t\t) : (\n\t\t\t\t<Placeholder layoutClassNames={ layoutClassNames } />\n\t\t\t) }\n\t\t</RecursionProvider>\n\t);\n}\n"],"mappings":"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"}