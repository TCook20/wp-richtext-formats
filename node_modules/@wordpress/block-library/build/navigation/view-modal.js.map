{"version":3,"names":["_micromodal","_interopRequireDefault","require","navigationToggleModal","modal","isHidden","dialogContainer","querySelector","classList","toggle","toggleAttribute","removeAttribute","setAttribute","document","documentElement","isLinkToAnchorOnCurrentPage","node","hash","protocol","window","location","host","pathname","search","onShow","addEventListener","handleAnchorLinkClicksInsideModal","passive","onClose","removeEventListener","event","link","target","closest","HTMLAnchorElement","attributes","modalId","getAttribute","contains","MicroModal","close","dataset","micromodalTrigger","show","openClass"],"sources":["@wordpress/block-library/src/navigation/view-modal.js"],"sourcesContent":["/*eslint-env browser*/\n/**\n * External dependencies\n */\nimport MicroModal from 'micromodal';\n\n// Responsive navigation toggle.\n\n/**\n * Toggles responsive navigation.\n *\n * @param {HTMLDivElement} modal\n * @param {boolean}        isHidden\n */\nfunction navigationToggleModal( modal, isHidden ) {\n\tconst dialogContainer = modal.querySelector(\n\t\t`.wp-block-navigation__responsive-dialog`\n\t);\n\n\tmodal.classList.toggle( 'has-modal-open', ! isHidden );\n\tdialogContainer.toggleAttribute( 'aria-modal', ! isHidden );\n\n\tif ( isHidden ) {\n\t\tdialogContainer.removeAttribute( 'role' );\n\t\tdialogContainer.removeAttribute( 'aria-modal' );\n\t} else {\n\t\tdialogContainer.setAttribute( 'role', 'dialog' );\n\t\tdialogContainer.setAttribute( 'aria-modal', 'true' );\n\t}\n\n\t// Add a class to indicate the modal is open.\n\tdocument.documentElement.classList.toggle( 'has-modal-open' );\n}\n\n/**\n * Checks whether the provided link is an anchor on the current page.\n *\n * @param {HTMLAnchorElement} node\n * @return {boolean} Is anchor.\n */\nfunction isLinkToAnchorOnCurrentPage( node ) {\n\treturn (\n\t\tnode.hash &&\n\t\tnode.protocol === window.location.protocol &&\n\t\tnode.host === window.location.host &&\n\t\tnode.pathname === window.location.pathname &&\n\t\tnode.search === window.location.search\n\t);\n}\n\n/**\n * Handles effects after opening the modal.\n *\n * @param {HTMLDivElement} modal\n */\nfunction onShow( modal ) {\n\tnavigationToggleModal( modal, false );\n\tmodal.addEventListener( 'click', handleAnchorLinkClicksInsideModal, {\n\t\tpassive: true,\n\t} );\n}\n\n/**\n * Handles effects after closing the modal.\n *\n * @param {HTMLDivElement} modal\n */\nfunction onClose( modal ) {\n\tnavigationToggleModal( modal, true );\n\tmodal.removeEventListener( 'click', handleAnchorLinkClicksInsideModal, {\n\t\tpassive: true,\n\t} );\n}\n\n/**\n * Handle clicks to anchor links in modal using event delegation by closing modal automatically\n *\n * @param {UIEvent} event\n */\nfunction handleAnchorLinkClicksInsideModal( event ) {\n\tconst link = event.target.closest( '.wp-block-navigation-item__content' );\n\tif ( ! ( link instanceof HTMLAnchorElement ) ) {\n\t\treturn;\n\t}\n\n\t// Ignore non-anchor links and anchor links which open on a new tab.\n\tif (\n\t\t! isLinkToAnchorOnCurrentPage( link ) ||\n\t\tlink.attributes?.target === '_blank'\n\t) {\n\t\treturn;\n\t}\n\n\t// Find the specific parent modal for this link\n\t// since .close() won't work without an ID if there are\n\t// multiple navigation menus in a post/page.\n\tconst modal = link.closest( '.wp-block-navigation__responsive-container' );\n\tconst modalId = modal?.getAttribute( 'id' );\n\tif ( ! modalId ) {\n\t\treturn;\n\t}\n\n\t// check if modal exists and is open before trying to close it\n\t// otherwise Micromodal will toggle the `has-modal-open` class\n\t// on the html tag which prevents scrolling\n\tif ( modalId && modal.classList.contains( 'has-modal-open' ) ) {\n\t\tMicroModal.close( modalId );\n\t}\n}\n\n// MicroModal.init() does not support event delegation for the open trigger, so here MicroModal.show() is called manually.\ndocument.addEventListener(\n\t'click',\n\t( event ) => {\n\t\t/** @type {HTMLElement} */\n\t\tconst target = event.target;\n\n\t\tif ( target.dataset.micromodalTrigger ) {\n\t\t\tMicroModal.show( target.dataset.micromodalTrigger, {\n\t\t\t\tonShow,\n\t\t\t\tonClose,\n\t\t\t\topenClass: 'is-menu-open',\n\t\t\t} );\n\t\t}\n\t},\n\t{ passive: true }\n);\n"],"mappings":"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"}