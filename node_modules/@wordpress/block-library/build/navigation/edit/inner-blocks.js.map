{"version":3,"names":["_element","require","_coreData","_blockEditor","_data","_placeholderPreview","_interopRequireDefault","_constants","NavigationInnerBlocks","clientId","hasCustomPlaceholder","orientation","templateLock","isImmediateParentOfSelectedBlock","selectedBlockHasChildren","isSelected","useSelect","select","getBlockCount","hasSelectedInnerBlock","getSelectedBlockClientId","blockEditorStore","selectedBlockId","blocks","onInput","onChange","useEntityBlockEditor","shouldDirectInsert","useMemo","every","name","parentOrChildHasSelection","placeholder","createElement","default","hasMenuItems","length","showPlaceholder","innerBlocksProps","useInnerBlocksProps","className","value","allowedBlocks","ALLOWED_BLOCKS","prioritizedInserterBlocks","PRIORITIZED_INSERTER_BLOCKS","defaultBlock","DEFAULT_BLOCK","directInsert","renderAppender","InnerBlocks","ButtonBlockAppender","undefined","__experimentalCaptureToolbars"],"sources":["@wordpress/block-library/src/navigation/edit/inner-blocks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEntityBlockEditor } from '@wordpress/core-data';\nimport {\n\tuseInnerBlocksProps,\n\tInnerBlocks,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { useSelect } from '@wordpress/data';\nimport { useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport PlaceholderPreview from './placeholder/placeholder-preview';\nimport {\n\tDEFAULT_BLOCK,\n\tALLOWED_BLOCKS,\n\tPRIORITIZED_INSERTER_BLOCKS,\n} from '../constants';\n\nexport default function NavigationInnerBlocks( {\n\tclientId,\n\thasCustomPlaceholder,\n\torientation,\n\ttemplateLock,\n} ) {\n\tconst {\n\t\tisImmediateParentOfSelectedBlock,\n\t\tselectedBlockHasChildren,\n\t\tisSelected,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetBlockCount,\n\t\t\t\thasSelectedInnerBlock,\n\t\t\t\tgetSelectedBlockClientId,\n\t\t\t} = select( blockEditorStore );\n\t\t\tconst selectedBlockId = getSelectedBlockClientId();\n\n\t\t\treturn {\n\t\t\t\tisImmediateParentOfSelectedBlock: hasSelectedInnerBlock(\n\t\t\t\t\tclientId,\n\t\t\t\t\tfalse\n\t\t\t\t),\n\t\t\t\tselectedBlockHasChildren: !! getBlockCount( selectedBlockId ),\n\n\t\t\t\t// This prop is already available but computing it here ensures it's\n\t\t\t\t// fresh compared to isImmediateParentOfSelectedBlock.\n\t\t\t\tisSelected: selectedBlockId === clientId,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst [ blocks, onInput, onChange ] = useEntityBlockEditor(\n\t\t'postType',\n\t\t'wp_navigation'\n\t);\n\n\tconst shouldDirectInsert = useMemo(\n\t\t() =>\n\t\t\tblocks.every(\n\t\t\t\t( { name } ) =>\n\t\t\t\t\tname === 'core/navigation-link' ||\n\t\t\t\t\tname === 'core/navigation-submenu' ||\n\t\t\t\t\tname === 'core/page-list'\n\t\t\t),\n\t\t[ blocks ]\n\t);\n\n\t// When the block is selected itself or has a top level item selected that\n\t// doesn't itself have children, show the standard appender. Else show no\n\t// appender.\n\tconst parentOrChildHasSelection =\n\t\tisSelected ||\n\t\t( isImmediateParentOfSelectedBlock && ! selectedBlockHasChildren );\n\n\tconst placeholder = useMemo( () => <PlaceholderPreview />, [] );\n\n\tconst hasMenuItems = !! blocks?.length;\n\n\t// If there is a `ref` attribute pointing to a `wp_navigation` but\n\t// that menu has no **items** (i.e. empty) then show a placeholder.\n\t// The block must also be selected else the placeholder will display\n\t// alongside the appender.\n\tconst showPlaceholder =\n\t\t! hasCustomPlaceholder && ! hasMenuItems && ! isSelected;\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{\n\t\t\tclassName: 'wp-block-navigation__container',\n\t\t},\n\t\t{\n\t\t\tvalue: blocks,\n\t\t\tonInput,\n\t\t\tonChange,\n\t\t\tallowedBlocks: ALLOWED_BLOCKS,\n\t\t\tprioritizedInserterBlocks: PRIORITIZED_INSERTER_BLOCKS,\n\t\t\tdefaultBlock: DEFAULT_BLOCK,\n\t\t\tdirectInsert: shouldDirectInsert,\n\t\t\torientation,\n\t\t\ttemplateLock,\n\n\t\t\t// As an exception to other blocks which feature nesting, show\n\t\t\t// the block appender even when a child block is selected.\n\t\t\t// This should be a temporary fix, to be replaced by improvements to\n\t\t\t// the sibling inserter.\n\t\t\t// See https://github.com/WordPress/gutenberg/issues/37572.\n\t\t\trenderAppender:\n\t\t\t\tisSelected ||\n\t\t\t\t( isImmediateParentOfSelectedBlock &&\n\t\t\t\t\t! selectedBlockHasChildren ) ||\n\t\t\t\t// Show the appender while dragging to allow inserting element between item and the appender.\n\t\t\t\tparentOrChildHasSelection\n\t\t\t\t\t? InnerBlocks.ButtonBlockAppender\n\t\t\t\t\t: false,\n\t\t\tplaceholder: showPlaceholder ? placeholder : undefined,\n\t\t\t__experimentalCaptureToolbars: true,\n\t\t}\n\t);\n\n\treturn <div { ...innerBlocksProps } />;\n}\n"],"mappings":";;;;;;;AAUA,IAAAA,QAAA,GAAAC,OAAA;AAPA,IAAAC,SAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AAKA,IAAAG,KAAA,GAAAH,OAAA;AAMA,IAAAI,mBAAA,GAAAC,sBAAA,CAAAL,OAAA;AACA,IAAAM,UAAA,GAAAN,OAAA;AAhBA;AACA;AACA;;AAUA;AACA;AACA;;AAQe,SAASO,qBAAqBA,CAAE;EAC9CC,QAAQ;EACRC,oBAAoB;EACpBC,WAAW;EACXC;AACD,CAAC,EAAG;EACH,MAAM;IACLC,gCAAgC;IAChCC,wBAAwB;IACxBC;EACD,CAAC,GAAG,IAAAC,eAAS,EACVC,MAAM,IAAM;IACb,MAAM;MACLC,aAAa;MACbC,qBAAqB;MACrBC;IACD,CAAC,GAAGH,MAAM,CAAEI,kBAAiB,CAAC;IAC9B,MAAMC,eAAe,GAAGF,wBAAwB,CAAC,CAAC;IAElD,OAAO;MACNP,gCAAgC,EAAEM,qBAAqB,CACtDV,QAAQ,EACR,KACD,CAAC;MACDK,wBAAwB,EAAE,CAAC,CAAEI,aAAa,CAAEI,eAAgB,CAAC;MAE7D;MACA;MACAP,UAAU,EAAEO,eAAe,KAAKb;IACjC,CAAC;EACF,CAAC,EACD,CAAEA,QAAQ,CACX,CAAC;EAED,MAAM,CAAEc,MAAM,EAAEC,OAAO,EAAEC,QAAQ,CAAE,GAAG,IAAAC,8BAAoB,EACzD,UAAU,EACV,eACD,CAAC;EAED,MAAMC,kBAAkB,GAAG,IAAAC,gBAAO,EACjC,MACCL,MAAM,CAACM,KAAK,CACX,CAAE;IAAEC;EAAK,CAAC,KACTA,IAAI,KAAK,sBAAsB,IAC/BA,IAAI,KAAK,yBAAyB,IAClCA,IAAI,KAAK,gBACX,CAAC,EACF,CAAEP,MAAM,CACT,CAAC;;EAED;EACA;EACA;EACA,MAAMQ,yBAAyB,GAC9BhB,UAAU,IACRF,gCAAgC,IAAI,CAAEC,wBAA0B;EAEnE,MAAMkB,WAAW,GAAG,IAAAJ,gBAAO,EAAE,MAAM,IAAA5B,QAAA,CAAAiC,aAAA,EAAC5B,mBAAA,CAAA6B,OAAkB,MAAE,CAAC,EAAE,EAAG,CAAC;EAE/D,MAAMC,YAAY,GAAG,CAAC,CAAEZ,MAAM,EAAEa,MAAM;;EAEtC;EACA;EACA;EACA;EACA,MAAMC,eAAe,GACpB,CAAE3B,oBAAoB,IAAI,CAAEyB,YAAY,IAAI,CAAEpB,UAAU;EAEzD,MAAMuB,gBAAgB,GAAG,IAAAC,gCAAmB,EAC3C;IACCC,SAAS,EAAE;EACZ,CAAC,EACD;IACCC,KAAK,EAAElB,MAAM;IACbC,OAAO;IACPC,QAAQ;IACRiB,aAAa,EAAEC,yBAAc;IAC7BC,yBAAyB,EAAEC,sCAA2B;IACtDC,YAAY,EAAEC,wBAAa;IAC3BC,YAAY,EAAErB,kBAAkB;IAChChB,WAAW;IACXC,YAAY;IAEZ;IACA;IACA;IACA;IACA;IACAqC,cAAc,EACblC,UAAU,IACRF,gCAAgC,IACjC,CAAEC,wBAA0B;IAC7B;IACAiB,yBAAyB,GACtBmB,wBAAW,CAACC,mBAAmB,GAC/B,KAAK;IACTnB,WAAW,EAAEK,eAAe,GAAGL,WAAW,GAAGoB,SAAS;IACtDC,6BAA6B,EAAE;EAChC,CACD,CAAC;EAED,OAAO,IAAArD,QAAA,CAAAiC,aAAA;IAAA,GAAUK;EAAgB,CAAI,CAAC;AACvC"}