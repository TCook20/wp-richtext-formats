{"version":3,"names":["_element","require","_data","_blocks","_blockEditor","_components","_i18n","_utils","QueryPlaceholder","attributes","clientId","name","openPatternSelectionModal","setAttributes","isStartingBlank","setIsStartingBlank","useState","blockProps","useBlockProps","blockNameForPatterns","useBlockNameForPatterns","blockType","allVariations","hasPatterns","useSelect","select","getBlockVariations","getBlockType","blocksStore","getBlockRootClientId","getPatternsByBlockTypes","blockEditorStore","rootClientId","length","matchingVariation","getMatchingVariation","icon","src","label","title","createElement","QueryVariationPicker","Placeholder","instructions","__","Button","variant","onClick","scopeVariations","useScopedBlockVariations","replaceInnerBlocks","useDispatch","__experimentalBlockVariationPicker","variations","onSelect","variation","query","postType","namespace","innerBlocks","createBlocksFromInnerBlocksTemplate"],"sources":["@wordpress/block-library/src/query/edit/query-placeholder.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport {\n\tcreateBlocksFromInnerBlocksTemplate,\n\tstore as blocksStore,\n} from '@wordpress/blocks';\nimport { useState } from '@wordpress/element';\nimport {\n\tuseBlockProps,\n\tstore as blockEditorStore,\n\t__experimentalBlockVariationPicker,\n\t__experimentalGetMatchingVariation as getMatchingVariation,\n} from '@wordpress/block-editor';\nimport { Button, Placeholder } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { useScopedBlockVariations, useBlockNameForPatterns } from '../utils';\n\nexport default function QueryPlaceholder( {\n\tattributes,\n\tclientId,\n\tname,\n\topenPatternSelectionModal,\n\tsetAttributes,\n} ) {\n\tconst [ isStartingBlank, setIsStartingBlank ] = useState( false );\n\tconst blockProps = useBlockProps();\n\tconst blockNameForPatterns = useBlockNameForPatterns(\n\t\tclientId,\n\t\tattributes\n\t);\n\n\tconst { blockType, allVariations, hasPatterns } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockVariations, getBlockType } = select( blocksStore );\n\t\t\tconst { getBlockRootClientId, getPatternsByBlockTypes } =\n\t\t\t\tselect( blockEditorStore );\n\t\t\tconst rootClientId = getBlockRootClientId( clientId );\n\t\t\treturn {\n\t\t\t\tblockType: getBlockType( name ),\n\t\t\t\tallVariations: getBlockVariations( name ),\n\t\t\t\thasPatterns: !! getPatternsByBlockTypes(\n\t\t\t\t\tblockNameForPatterns,\n\t\t\t\t\trootClientId\n\t\t\t\t).length,\n\t\t\t};\n\t\t},\n\t\t[ name, blockNameForPatterns, clientId ]\n\t);\n\n\tconst matchingVariation = getMatchingVariation( attributes, allVariations );\n\tconst icon =\n\t\tmatchingVariation?.icon?.src ||\n\t\tmatchingVariation?.icon ||\n\t\tblockType?.icon?.src;\n\tconst label = matchingVariation?.title || blockType?.title;\n\tif ( isStartingBlank ) {\n\t\treturn (\n\t\t\t<QueryVariationPicker\n\t\t\t\tclientId={ clientId }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ label }\n\t\t\t/>\n\t\t);\n\t}\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<Placeholder\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ label }\n\t\t\t\tinstructions={ __(\n\t\t\t\t\t'Choose a pattern for the query loop or start blank.'\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t{ !! hasPatterns && (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tonClick={ openPatternSelectionModal }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Choose' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) }\n\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tsetIsStartingBlank( true );\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Start blank' ) }\n\t\t\t\t</Button>\n\t\t\t</Placeholder>\n\t\t</div>\n\t);\n}\n\nfunction QueryVariationPicker( {\n\tclientId,\n\tattributes,\n\tsetAttributes,\n\ticon,\n\tlabel,\n} ) {\n\tconst scopeVariations = useScopedBlockVariations( attributes );\n\tconst { replaceInnerBlocks } = useDispatch( blockEditorStore );\n\tconst blockProps = useBlockProps();\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<__experimentalBlockVariationPicker\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ label }\n\t\t\t\tvariations={ scopeVariations }\n\t\t\t\tonSelect={ ( variation ) => {\n\t\t\t\t\tif ( variation.attributes ) {\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t...variation.attributes,\n\t\t\t\t\t\t\tquery: {\n\t\t\t\t\t\t\t\t...variation.attributes.query,\n\t\t\t\t\t\t\t\tpostType:\n\t\t\t\t\t\t\t\t\tattributes.query.postType ||\n\t\t\t\t\t\t\t\t\tvariation.attributes.query.postType,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tnamespace: attributes.namespace,\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tif ( variation.innerBlocks ) {\n\t\t\t\t\t\treplaceInnerBlocks(\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\tcreateBlocksFromInnerBlocksTemplate(\n\t\t\t\t\t\t\t\tvariation.innerBlocks\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tfalse\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"mappings":"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"}