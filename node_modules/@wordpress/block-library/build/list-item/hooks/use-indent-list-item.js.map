{"version":3,"names":["_element","require","_data","_blockEditor","_blocks","useIndentListItem","clientId","canIndent","useSelect","select","blockEditorStore","getBlockIndex","replaceBlocks","selectionChange","multiSelect","useDispatch","getBlock","getPreviousBlockClientId","getSelectionStart","getSelectionEnd","hasMultiSelection","getMultiSelectedBlockClientIds","useCallback","_hasMultiSelection","clientIds","clonedBlocks","map","_clientId","cloneBlock","previousSiblingId","newListItem","innerBlocks","length","createBlock","push","selectionStart","selectionEnd","attributeKey","offset"],"sources":["@wordpress/block-library/src/list-item/hooks/use-indent-list-item.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useCallback } from '@wordpress/element';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { createBlock, cloneBlock } from '@wordpress/blocks';\n\nexport default function useIndentListItem( clientId ) {\n\tconst canIndent = useSelect(\n\t\t( select ) => select( blockEditorStore ).getBlockIndex( clientId ) > 0,\n\t\t[ clientId ]\n\t);\n\tconst { replaceBlocks, selectionChange, multiSelect } =\n\t\tuseDispatch( blockEditorStore );\n\tconst {\n\t\tgetBlock,\n\t\tgetPreviousBlockClientId,\n\t\tgetSelectionStart,\n\t\tgetSelectionEnd,\n\t\thasMultiSelection,\n\t\tgetMultiSelectedBlockClientIds,\n\t} = useSelect( blockEditorStore );\n\treturn [\n\t\tcanIndent,\n\t\tuseCallback( () => {\n\t\t\tconst _hasMultiSelection = hasMultiSelection();\n\t\t\tconst clientIds = _hasMultiSelection\n\t\t\t\t? getMultiSelectedBlockClientIds()\n\t\t\t\t: [ clientId ];\n\t\t\tconst clonedBlocks = clientIds.map( ( _clientId ) =>\n\t\t\t\tcloneBlock( getBlock( _clientId ) )\n\t\t\t);\n\t\t\tconst previousSiblingId = getPreviousBlockClientId( clientId );\n\t\t\tconst newListItem = cloneBlock( getBlock( previousSiblingId ) );\n\t\t\t// If the sibling has no innerBlocks, create a new `list` block.\n\t\t\tif ( ! newListItem.innerBlocks?.length ) {\n\t\t\t\tnewListItem.innerBlocks = [ createBlock( 'core/list' ) ];\n\t\t\t}\n\t\t\t// A list item usually has one `list`, but it's possible to have\n\t\t\t// more. So we need to preserve the previous `list` blocks and\n\t\t\t// merge the new blocks to the last `list`.\n\t\t\tnewListItem.innerBlocks[\n\t\t\t\tnewListItem.innerBlocks.length - 1\n\t\t\t].innerBlocks.push( ...clonedBlocks );\n\n\t\t\t// We get the selection start/end here, because when\n\t\t\t// we replace blocks, the selection is updated too.\n\t\t\tconst selectionStart = getSelectionStart();\n\t\t\tconst selectionEnd = getSelectionEnd();\n\t\t\t// Replace the previous sibling of the block being indented and the indented blocks,\n\t\t\t// with a new block whose attributes are equal to the ones of the previous sibling and\n\t\t\t// whose descendants are the children of the previous sibling, followed by the indented blocks.\n\t\t\treplaceBlocks(\n\t\t\t\t[ previousSiblingId, ...clientIds ],\n\t\t\t\t[ newListItem ]\n\t\t\t);\n\t\t\tif ( ! _hasMultiSelection ) {\n\t\t\t\tselectionChange(\n\t\t\t\t\tclonedBlocks[ 0 ].clientId,\n\t\t\t\t\tselectionEnd.attributeKey,\n\t\t\t\t\tselectionEnd.clientId === selectionStart.clientId\n\t\t\t\t\t\t? selectionStart.offset\n\t\t\t\t\t\t: selectionEnd.offset,\n\t\t\t\t\tselectionEnd.offset\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tmultiSelect(\n\t\t\t\t\tclonedBlocks[ 0 ].clientId,\n\t\t\t\t\tclonedBlocks[ clonedBlocks.length - 1 ].clientId\n\t\t\t\t);\n\t\t\t}\n\t\t}, [ clientId ] ),\n\t];\n}\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AANA;AACA;AACA;;AAMe,SAASI,iBAAiBA,CAAEC,QAAQ,EAAG;EACrD,MAAMC,SAAS,GAAG,IAAAC,eAAS,EACxBC,MAAM,IAAMA,MAAM,CAAEC,kBAAiB,CAAC,CAACC,aAAa,CAAEL,QAAS,CAAC,GAAG,CAAC,EACtE,CAAEA,QAAQ,CACX,CAAC;EACD,MAAM;IAAEM,aAAa;IAAEC,eAAe;IAAEC;EAAY,CAAC,GACpD,IAAAC,iBAAW,EAAEL,kBAAiB,CAAC;EAChC,MAAM;IACLM,QAAQ;IACRC,wBAAwB;IACxBC,iBAAiB;IACjBC,eAAe;IACfC,iBAAiB;IACjBC;EACD,CAAC,GAAG,IAAAb,eAAS,EAAEE,kBAAiB,CAAC;EACjC,OAAO,CACNH,SAAS,EACT,IAAAe,oBAAW,EAAE,MAAM;IAClB,MAAMC,kBAAkB,GAAGH,iBAAiB,CAAC,CAAC;IAC9C,MAAMI,SAAS,GAAGD,kBAAkB,GACjCF,8BAA8B,CAAC,CAAC,GAChC,CAAEf,QAAQ,CAAE;IACf,MAAMmB,YAAY,GAAGD,SAAS,CAACE,GAAG,CAAIC,SAAS,IAC9C,IAAAC,kBAAU,EAAEZ,QAAQ,CAAEW,SAAU,CAAE,CACnC,CAAC;IACD,MAAME,iBAAiB,GAAGZ,wBAAwB,CAAEX,QAAS,CAAC;IAC9D,MAAMwB,WAAW,GAAG,IAAAF,kBAAU,EAAEZ,QAAQ,CAAEa,iBAAkB,CAAE,CAAC;IAC/D;IACA,IAAK,CAAEC,WAAW,CAACC,WAAW,EAAEC,MAAM,EAAG;MACxCF,WAAW,CAACC,WAAW,GAAG,CAAE,IAAAE,mBAAW,EAAE,WAAY,CAAC,CAAE;IACzD;IACA;IACA;IACA;IACAH,WAAW,CAACC,WAAW,CACtBD,WAAW,CAACC,WAAW,CAACC,MAAM,GAAG,CAAC,CAClC,CAACD,WAAW,CAACG,IAAI,CAAE,GAAGT,YAAa,CAAC;;IAErC;IACA;IACA,MAAMU,cAAc,GAAGjB,iBAAiB,CAAC,CAAC;IAC1C,MAAMkB,YAAY,GAAGjB,eAAe,CAAC,CAAC;IACtC;IACA;IACA;IACAP,aAAa,CACZ,CAAEiB,iBAAiB,EAAE,GAAGL,SAAS,CAAE,EACnC,CAAEM,WAAW,CACd,CAAC;IACD,IAAK,CAAEP,kBAAkB,EAAG;MAC3BV,eAAe,CACdY,YAAY,CAAE,CAAC,CAAE,CAACnB,QAAQ,EAC1B8B,YAAY,CAACC,YAAY,EACzBD,YAAY,CAAC9B,QAAQ,KAAK6B,cAAc,CAAC7B,QAAQ,GAC9C6B,cAAc,CAACG,MAAM,GACrBF,YAAY,CAACE,MAAM,EACtBF,YAAY,CAACE,MACd,CAAC;IACF,CAAC,MAAM;MACNxB,WAAW,CACVW,YAAY,CAAE,CAAC,CAAE,CAACnB,QAAQ,EAC1BmB,YAAY,CAAEA,YAAY,CAACO,MAAM,GAAG,CAAC,CAAE,CAAC1B,QACzC,CAAC;IACF;EACD,CAAC,EAAE,CAAEA,QAAQ,CAAG,CAAC,CACjB;AACF"}