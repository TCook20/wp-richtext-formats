{"version":3,"names":["Path","SVG","Popover","Button","__experimentalNumberControl","NumberControl","__experimentalHStack","HStack","__","useState","insertObject","useAnchor","MediaUpload","RichTextToolbarButton","MediaUploadCheck","keyboardReturn","ALLOWED_MEDIA_TYPES","name","title","image","keywords","object","tagName","className","attributes","style","url","alt","edit","Edit","InlineUI","value","onChange","activeObjectAttributes","contentRef","width","setWidth","replace","popoverAnchor","editableContentElement","current","settings","createElement","placement","focusOnMount","anchor","onSubmit","event","newReplacements","replacements","slice","start","type","preventDefault","alignment","spacing","label","min","newWidth","icon","onFocus","isObjectActive","isModalOpen","setIsModalOpen","openModal","closeModal","xmlns","viewBox","d","onClick","isActive","allowedTypes","onSelect","id","imgWidth","Math","onClose","render","open"],"sources":["@wordpress/format-library/src/image/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tPath,\n\tSVG,\n\tPopover,\n\tButton,\n\t__experimentalNumberControl as NumberControl,\n\t__experimentalHStack as HStack,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useState } from '@wordpress/element';\nimport { insertObject, useAnchor } from '@wordpress/rich-text';\nimport {\n\tMediaUpload,\n\tRichTextToolbarButton,\n\tMediaUploadCheck,\n} from '@wordpress/block-editor';\nimport { keyboardReturn } from '@wordpress/icons';\n\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nconst name = 'core/image';\nconst title = __( 'Inline image' );\n\nexport const image = {\n\tname,\n\ttitle,\n\tkeywords: [ __( 'photo' ), __( 'media' ) ],\n\tobject: true,\n\ttagName: 'img',\n\tclassName: null,\n\tattributes: {\n\t\tclassName: 'class',\n\t\tstyle: 'style',\n\t\turl: 'src',\n\t\talt: 'alt',\n\t},\n\tedit: Edit,\n};\n\nfunction InlineUI( { value, onChange, activeObjectAttributes, contentRef } ) {\n\tconst { style } = activeObjectAttributes;\n\tconst [ width, setWidth ] = useState( style?.replace( /\\D/g, '' ) );\n\tconst popoverAnchor = useAnchor( {\n\t\teditableContentElement: contentRef.current,\n\t\tsettings: image,\n\t} );\n\n\treturn (\n\t\t<Popover\n\t\t\tplacement=\"bottom\"\n\t\t\tfocusOnMount={ false }\n\t\t\tanchor={ popoverAnchor }\n\t\t\tclassName=\"block-editor-format-toolbar__image-popover\"\n\t\t>\n\t\t\t<form\n\t\t\t\tclassName=\"block-editor-format-toolbar__image-container-content\"\n\t\t\t\tonSubmit={ ( event ) => {\n\t\t\t\t\tconst newReplacements = value.replacements.slice();\n\n\t\t\t\t\tnewReplacements[ value.start ] = {\n\t\t\t\t\t\ttype: name,\n\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t...activeObjectAttributes,\n\t\t\t\t\t\t\tstyle: width ? `width: ${ width }px;` : '',\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tonChange( {\n\t\t\t\t\t\t...value,\n\t\t\t\t\t\treplacements: newReplacements,\n\t\t\t\t\t} );\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t<HStack alignment=\"bottom\" spacing=\"0\">\n\t\t\t\t\t<NumberControl\n\t\t\t\t\t\tclassName=\"block-editor-format-toolbar__image-container-value\"\n\t\t\t\t\t\tlabel={ __( 'Width' ) }\n\t\t\t\t\t\tvalue={ width }\n\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\tonChange={ ( newWidth ) => setWidth( newWidth ) }\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"block-editor-format-toolbar__image-container-button\"\n\t\t\t\t\t\ticon={ keyboardReturn }\n\t\t\t\t\t\tlabel={ __( 'Apply' ) }\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t/>\n\t\t\t\t</HStack>\n\t\t\t</form>\n\t\t</Popover>\n\t);\n}\n\nfunction Edit( {\n\tvalue,\n\tonChange,\n\tonFocus,\n\tisObjectActive,\n\tactiveObjectAttributes,\n\tcontentRef,\n} ) {\n\tconst [ isModalOpen, setIsModalOpen ] = useState( false );\n\n\tfunction openModal() {\n\t\tsetIsModalOpen( true );\n\t}\n\n\tfunction closeModal() {\n\t\tsetIsModalOpen( false );\n\t}\n\n\treturn (\n\t\t<MediaUploadCheck>\n\t\t\t<RichTextToolbarButton\n\t\t\t\ticon={\n\t\t\t\t\t<SVG xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t<Path d=\"M4 18.5h16V17H4v1.5zM16 13v1.5h4V13h-4zM5.1 15h7.8c.6 0 1.1-.5 1.1-1.1V6.1c0-.6-.5-1.1-1.1-1.1H5.1C4.5 5 4 5.5 4 6.1v7.8c0 .6.5 1.1 1.1 1.1zm.4-8.5h7V10l-1-1c-.3-.3-.8-.3-1 0l-1.6 1.5-1.2-.7c-.3-.2-.6-.2-.9 0l-1.3 1V6.5zm0 6.1l1.8-1.3 1.3.8c.3.2.7.2.9-.1l1.5-1.4 1.5 1.4v1.5h-7v-.9z\" />\n\t\t\t\t\t</SVG>\n\t\t\t\t}\n\t\t\t\ttitle={ title }\n\t\t\t\tonClick={ openModal }\n\t\t\t\tisActive={ isObjectActive }\n\t\t\t/>\n\t\t\t{ isModalOpen && (\n\t\t\t\t<MediaUpload\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\tonSelect={ ( { id, url, alt, width: imgWidth } ) => {\n\t\t\t\t\t\tcloseModal();\n\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\tinsertObject( value, {\n\t\t\t\t\t\t\t\ttype: name,\n\t\t\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t\t\tclassName: `wp-image-${ id }`,\n\t\t\t\t\t\t\t\t\tstyle: `width: ${ Math.min(\n\t\t\t\t\t\t\t\t\t\timgWidth,\n\t\t\t\t\t\t\t\t\t\t150\n\t\t\t\t\t\t\t\t\t) }px;`,\n\t\t\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t\t\talt,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tonFocus();\n\t\t\t\t\t} }\n\t\t\t\t\tonClose={ closeModal }\n\t\t\t\t\trender={ ( { open } ) => {\n\t\t\t\t\t\topen();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ isObjectActive && (\n\t\t\t\t<InlineUI\n\t\t\t\t\tvalue={ value }\n\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\tactiveObjectAttributes={ activeObjectAttributes }\n\t\t\t\t\tcontentRef={ contentRef }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</MediaUploadCheck>\n\t);\n}\n"],"mappings":"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"}